{"version":3,"file":"Verification.js","sources":["../../../../src/components/inputs/Verification/Verification.tsx"],"sourcesContent":["/* eslint-disable jsx-a11y/no-autofocus */\nimport React, { FC, useRef, useMemo } from 'react'\nimport { VerificationProps } from './types'\nimport './Verification.scss'\n\nconst Verification: FC<VerificationProps> = ({\n  isUseAutofocus = false,\n  error,\n  fieldsQuantity = 4,\n  value,\n  onChange,\n}) => {\n  const state = error ? 'Error' : null\n\n  const inputs = useRef<(HTMLInputElement | null)[]>([])\n  const desiredFieldsQuantity = useMemo(\n    () =>\n      Array(fieldsQuantity)\n        .fill(0)\n        .map((_, index) => index),\n    [fieldsQuantity],\n  )\n\n  const processInput = (e, slot): void => {\n    if (/[^0-9]/.test(e.target.value)) {\n      e.target.value = ''\n    } else {\n      let newInputsArr = [...value]\n      newInputsArr[slot] = e.target.value.replace(value[slot], '')\n      const overLengthItem = newInputsArr.find((item) => item.length > 1)\n      if (overLengthItem) {\n        overLengthItem.split('').slice(0, 4 - newInputsArr.length)\n        const oldInputValue: string[] = []\n        value.forEach((item) => {\n          if (item) {\n            oldInputValue.push(item)\n          }\n        })\n        newInputsArr = [\n          ...oldInputValue,\n          ...overLengthItem.slice(0, 4 - oldInputValue.length),\n        ]\n      }\n      onChange(newInputsArr, inputs)\n\n      if (e.target.value !== '' && slot !== fieldsQuantity - 1) {\n        inputs?.current[slot + 1]?.focus()\n      }\n    }\n  }\n  const onKeyDown = (e, slot): void => {\n    if (e.keyCode === 8 || (e.keyCode === 46 && !value[slot] && slot !== 0)) {\n      if (!value[slot]) {\n        inputs?.current[slot - 1]?.focus()\n      }\n      const newInputsArr = [...value]\n      newInputsArr[slot] = ''\n      onChange(newInputsArr, inputs)\n    }\n    if (e.keyCode === 39 && slot !== fieldsQuantity - 1) {\n      inputs?.current[slot + 1]?.focus()\n    }\n    if (e.keyCode === 37 && slot !== 0) {\n      inputs?.current[slot - 1]?.focus()\n    }\n  }\n\n  return (\n    <div className='Verification'>\n      {error ? <span className={`Verification__${state}`}>{error}</span> : null}\n      {desiredFieldsQuantity.map((num, index) => (\n        <div key={index} className='Verification__InputWrapper'>\n          <input\n            ref={(ref): void => {\n              if (inputs.current.includes(ref) || !ref) {\n                return\n              }\n              inputs.current.push(ref)\n            }}\n            autoFocus={isUseAutofocus && !value[0]?.length && index === 0}\n            className={[\n              'Verification__Input',\n              `Verification__Input_${state ?? 'Static'}`,\n            ].join(' ')}\n            inputMode='numeric'\n            onChange={(e): void => {\n              e.preventDefault()\n              processInput(e, index)\n            }}\n            onKeyDown={(e): void => {\n              onKeyDown(e, index)\n            }}\n            required\n            type='text'\n            value={value[index]}\n          />\n          <span\n            className={[\n              'Verification__InputLine',\n              `Verification__InputLine_${state ?? 'Static'}`,\n            ].join(' ')}\n          />\n        </div>\n      ))}\n    </div>\n  )\n}\n\nexport default Verification\n"],"names":["isUseAutofocus","error","fieldsQuantity","value","onChange","state","inputs","useRef","desiredFieldsQuantity","useMemo","Array","fill","map","_","index","React","className","num","key","ref","current","includes","push","autoFocus","length","join","inputMode","e","preventDefault","slot","test","target","newInputsArr","replace","overLengthItem","find","item","split","slice","oldInputValue","forEach","focus","processInput","onKeyDown","keyCode","required","type"],"mappings":"sIAK4C,EAC1CA,eAAAA,GAAiB,EACjBC,MAAAA,EACAC,eAAAA,EAAiB,EACjBC,MAAAA,EACAC,SAAAA,MAEA,MAAMC,EAAQJ,EAAQ,QAAU,KAE1BK,EAASC,SAAoC,IAC7CC,EAAwBC,UAC5B,IACEC,MAAMR,GACHS,KAAK,GACLC,IAAI,CAACC,EAAGC,IAAUA,GACvB,CAACZ,IA+CH,OACEa,+BAAKC,UAAU,gBACZf,EAAQc,gCAAMC,UAAW,iBAAiBX,GAAUJ,GAAgB,KACpEO,EAAsBI,IAAI,CAACK,EAAKH,WAAU,OACzCC,+BAAKG,IAAKJ,EAAOE,UAAU,8BACzBD,iCACEI,IAAMA,KACAb,EAAOc,QAAQC,SAASF,IAASA,GAGrCb,EAAOc,QAAQE,KAAKH,IAEtBI,UAAWvB,eAAmBG,EAAM,yBAAIqB,SAAoB,IAAVV,EAClDE,UAAW,CACT,sBACA,wBAAuBX,MAAAA,EAAAA,EAAS,WAChCoB,KAAK,KACPC,UAAU,UACVtB,SAAWuB,IACTA,EAAEC,iBA/DO,EAACD,EAAGE,WACvB,GAAI,SAASC,KAAKH,EAAEI,OAAO5B,OACzBwB,EAAEI,OAAO5B,MAAQ,OACZ,CACL,IAAI6B,EAAe,IAAI7B,GACvB6B,EAAaH,GAAQF,EAAEI,OAAO5B,MAAM8B,QAAQ9B,EAAM0B,GAAO,IACzD,MAAMK,EAAiBF,EAAaG,KAAMC,GAASA,EAAKZ,OAAS,GACjE,GAAIU,EAAgB,CAClBA,EAAeG,MAAM,IAAIC,MAAM,EAAG,EAAIN,EAAaR,QACnD,MAAMe,EAA0B,GAChCpC,EAAMqC,QAASJ,IACTA,GACFG,EAAcjB,KAAKc,KAGvBJ,EAAe,IACVO,KACAL,EAAeI,MAAM,EAAG,EAAIC,EAAcf,SAGjDpB,EAAS4B,EAAc1B,GAEA,KAAnBqB,EAAEI,OAAO5B,OAAgB0B,IAAS3B,EAAiB,cACrDI,MAAAA,SAAAA,EAAQc,QAAQS,EAAO,mBAAIY,WAyCrBC,CAAaf,EAAGb,IAElB6B,UAAYhB,IAvCJ,EAACA,EAAGE,eACpB,GAAkB,IAAdF,EAAEiB,SAAgC,KAAdjB,EAAEiB,UAAmBzC,EAAM0B,IAAkB,IAATA,EAAa,CAClE1B,EAAM0B,cACTvB,MAAAA,SAAAA,EAAQc,QAAQS,EAAO,mBAAIY,QAE7B,MAAMT,EAAe,IAAI7B,GACzB6B,EAAaH,GAAQ,GACrBzB,EAAS4B,EAAc1B,GAEP,KAAdqB,EAAEiB,SAAkBf,IAAS3B,EAAiB,cAChDI,MAAAA,SAAAA,EAAQc,QAAQS,EAAO,mBAAIY,SAEX,KAAdd,EAAEiB,SAA2B,IAATf,cACtBvB,MAAAA,SAAAA,EAAQc,QAAQS,EAAO,mBAAIY,UA2BnBE,CAAUhB,EAAGb,IAEf+B,YACAC,KAAK,OACL3C,MAAOA,EAAMW,KAEfC,gCACEC,UAAW,CACT,0BACA,4BAA2BX,MAAAA,EAAAA,EAAS,WACpCoB,KAAK"}