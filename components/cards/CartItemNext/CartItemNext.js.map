{"version":3,"file":"CartItemNext.js","sources":["../../../../src/components/cards/CartItemNext/CartItemNext.tsx"],"sourcesContent":["import React, { createElement, FC, useEffect, useMemo, useState } from 'react'\nimport clsx from 'clsx'\nimport { kztAmount } from '../../../utils/money'\nimport { Condition } from '../../other/Condition'\nimport { LazyImage } from '../../other/LazyImage'\nimport { Skeleton } from '../../other/Skeleton'\nimport { Sticker } from '../../other/Sticker'\nimport { Typography } from '../../other/Typography'\nimport { ShowcaseBoxIcon } from '../../icons/ShowcaseBox'\nimport { DigitalIcon } from '../../icons/Digital'\nimport { CirclePlusIcon } from '../../icons/CirclePlus'\nimport { CircleMinusIcon } from '../../icons/CircleMinus'\nimport { PercentIcon } from '../../icons/Percent'\nimport { CartItemNextProps, ISticker } from './types'\nimport './CartItemNext.scss'\nimport { Button } from '../../buttons/Button'\n\nconst CartItemNext: FC<CartItemNextProps> = ({\n  className,\n  imgIcon,\n  imgSrc = '',\n  imgLqip = 'images/productCardThumbnail.png',\n  isCheckout,\n  oldPrice = 0,\n  price = 0,\n  quantity = 0,\n  stickers = [],\n  title = '',\n  isEsd = false,\n  isShowcase = false,\n  isOutOfStock = false,\n  deleteButtonText = '',\n  totalPrice = 0,\n  onDelete = (): boolean => false,\n  onDecrease = (): boolean => false,\n  onIncrease = (): boolean => false,\n  onBlur = (): boolean => false,\n  inStock = true,\n  isLoading = false,\n  isCountable = true,\n  isDeletable = true,\n  isDisabled,\n  shouldRenderQuantity = true,\n  esdTitle = 'Цифровой товар',\n  showcaseTitle = 'Товар с витрины',\n  isCascade = false,\n  cascadeTitle = 'На товар действует каскадная скидка',\n  link,\n  outOfStockTitle = 'Товара нет в наличии',\n  totalOldPrice = 0,\n}) => {\n  const shouldRenderOldPrice: boolean =\n    totalOldPrice > totalPrice || totalOldPrice > Number(totalPrice)\n  const hasStickers: boolean = stickers?.length > 0\n  const shouldBeCountable = isCountable && inStock\n  const totalNewOldPrice = totalOldPrice || quantity * oldPrice\n  const totalNewPrice = totalPrice || quantity * price\n  const [qty, setQty] = useState(quantity)\n\n  useEffect(() => {\n    setQty(quantity)\n  }, [quantity])\n\n  const onChangeSetValue = (event): void => {\n    setQty(Math.abs(event.target.value))\n  }\n\n  const topStickers = useMemo((): ISticker[] => {\n    const stickerList: ISticker[] = []\n\n    if (isCascade) {\n      stickerList.push({\n        backgroundColor: 'transparent',\n        color: 'var(--ui-green)',\n        icon: (\n          <div className='CartItemNext__TopStickerIcoPercentWrapper'>\n            <PercentIcon\n              className='CartItemNext__TopStickerIco'\n              height={20}\n              width={20}\n            />\n          </div>\n        ),\n        text: cascadeTitle,\n      })\n    }\n\n    if (isEsd) {\n      stickerList.push({\n        backgroundColor: 'transparent',\n        color: 'var(--ui-blue)',\n        icon: (\n          <DigitalIcon\n            className='CartItemNext__TopStickerIco'\n            height={20}\n            width={20}\n          />\n        ),\n        text: esdTitle,\n      })\n    }\n\n    if (isShowcase) {\n      stickerList.push({\n        backgroundColor: 'var(--gray-11)',\n        color: 'var(--ui-red)',\n        icon: (\n          <ShowcaseBoxIcon\n            className='CartItemNext__TopStickerIco --marginLeft'\n            fill='var(--ui-red)'\n            height={16}\n            width={16}\n          />\n        ),\n        text: showcaseTitle,\n      })\n    }\n\n    if (isOutOfStock) {\n      stickerList.push({\n        backgroundColor: 'var(--brand-yellow)',\n        color: 'var(--gray-90)',\n        text: outOfStockTitle,\n      })\n    }\n\n    return stickerList\n  }, [\n    isCascade,\n    isEsd,\n    isShowcase,\n    isOutOfStock,\n    cascadeTitle,\n    esdTitle,\n    outOfStockTitle,\n    showcaseTitle,\n  ])\n\n  return (\n    <Skeleton\n      className={clsx('CartItemNext__Skeleton', !isLoading && '--off')}\n      isLoading={isLoading}\n    >\n      <div\n        className={clsx('CartItemNext', className, {\n          '--isCheckout': isCheckout,\n          '--isCountable': shouldBeCountable,\n          '--noDeletable': !isDeletable,\n          '--noQuantity': !shouldRenderQuantity,\n        })}\n      >\n        <div className='CartItemNext__GridWrapper'>\n          <div className='CartItemNext__DeleteGrid CartItemNext__GridCell'>\n            <Button\n              className='CartItemNext__DeleteButton'\n              disabled={isDisabled}\n              onClick={onDelete}\n              size='S'\n              text={deleteButtonText}\n              theme='Tertiary'\n            />\n          </div>\n          <div className='CartItemNext__ImgGrid CartItemNext__GridCell'>\n            <div className='CartItemNext__ImgWrapper'>\n              <Skeleton\n                backgroundColor='#F7F7F7'\n                className={clsx(\n                  'CartItemNext__Skeleton',\n                  !isLoading && '--off',\n                )}\n                isLoading={isLoading}\n              >\n                <Condition match={Boolean(link)}>\n                  <a {...link}>\n                    {imgIcon ? (\n                      createElement(imgIcon, {\n                        className: 'CartItemNext__Img',\n                      })\n                    ) : (\n                      <LazyImage\n                        alt={title}\n                        className='CartItemNext__Img'\n                        lqip={imgLqip}\n                        src={imgSrc}\n                      />\n                    )}\n                  </a>\n                </Condition>\n                <Condition match={!link}>\n                  {imgIcon ? (\n                    createElement(imgIcon, {\n                      className: 'CartItemNext__Img',\n                    })\n                  ) : (\n                    <LazyImage\n                      alt={title}\n                      className='CartItemNext__Img'\n                      lqip={imgLqip}\n                      src={imgSrc}\n                    />\n                  )}\n                </Condition>\n              </Skeleton>\n            </div>\n          </div>\n          <div className='CartItemNext__InfoGrid CartItemNext__GridCell'>\n            <div className='CartItemNext__InfoWrapper'>\n              <div className='CartItemNext__TopStickerWrapper'>\n                <div className='CartItemNext__TopSticker'>\n                  {topStickers?.map((sticker) => (\n                    <Sticker\n                      className='CartItemNext__Sticker --paddingLeftOff'\n                      {...sticker}\n                    />\n                  ))}\n                </div>\n              </div>\n\n              <div className='CartItemNext__TitleAndQuantity'>\n                <Typography\n                  className='CartItemNext__Title'\n                  text={title}\n                  type={shouldBeCountable ? 'Body1B' : 'Body2B'}\n                />\n              </div>\n\n              {qty > 1 && (\n                <div className='CartItemNext__Prices'>\n                  <Typography\n                    className='CartItemNext__Price'\n                    text={kztAmount(price, '₸/шт')}\n                    type={shouldBeCountable ? 'Subtitle2' : 'Body1B'}\n                  />\n                </div>\n              )}\n              {hasStickers && (\n                <div className='CartItemNext__Stickers'>\n                  {stickers?.slice(0, 3).map((sticker, stickerIdx) => (\n                    <Sticker\n                      key={`CartItemNext__Sticker-${stickerIdx}`}\n                      className='CartItemNext__Sticker'\n                      {...sticker}\n                    />\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n          <div className='CartItemNext__PriceGrid CartItemNext__GridCell'>\n            <Typography\n              className={clsx(\n                'CartItemNext__Total',\n                shouldRenderOldPrice && '--highlighted',\n              )}\n              text={kztAmount(Number(totalNewPrice))}\n              type='Body1B'\n            />\n            {shouldRenderOldPrice && (\n              <Typography\n                className='CartItemNext__OldPriceTotalAmount'\n                text={kztAmount(Number(totalNewOldPrice))}\n                type={shouldBeCountable ? 'Caption1None' : 'Caption2None'}\n              />\n            )}\n          </div>\n          {shouldRenderQuantity && (\n            <div className='CartItemNext__CountGrid CartItemNext__GridCell'>\n              <div className='CartItemNext__ActionWrapper'>\n                <div className='CartItemNext__Action --offAction --increase'>\n                  <button disabled={isDisabled} onClick={onIncrease}>\n                    <CirclePlusIcon type='fill' />\n                  </button>\n                </div>\n                <div className='CartItemNext__Action --quantity'>\n                  {!shouldBeCountable ? (\n                    <Typography\n                      className='CartItemNext__Quantity'\n                      text={String(quantity)}\n                      type={isCheckout ? 'Subtitle2' : 'Body2B'}\n                    />\n                  ) : (\n                    <input\n                      autoComplete='off'\n                      className='CartItemNext__Action-QtySelector'\n                      disabled={isDisabled}\n                      id='QtySelector'\n                      onBlur={onBlur}\n                      onChange={onChangeSetValue}\n                      type='number'\n                      value={qty}\n                    />\n                  )}\n                </div>\n                <div className='CartItemNext__Action --decrease'>\n                  <button\n                    disabled={quantity < 1 || isDisabled}\n                    onClick={onDecrease}\n                  >\n                    <CircleMinusIcon type='fill' />\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </Skeleton>\n  )\n}\n\nexport default CartItemNext\n"],"names":["className","imgIcon","imgSrc","imgLqip","isCheckout","oldPrice","price","quantity","stickers","title","isEsd","isShowcase","isOutOfStock","deleteButtonText","totalPrice","onDelete","onDecrease","onIncrease","onBlur","inStock","isLoading","isCountable","isDeletable","isDisabled","shouldRenderQuantity","esdTitle","showcaseTitle","isCascade","cascadeTitle","link","outOfStockTitle","totalOldPrice","shouldRenderOldPrice","Number","hasStickers","length","shouldBeCountable","totalNewOldPrice","totalNewPrice","qty","setQty","useState","useEffect","topStickers","useMemo","stickerList","push","backgroundColor","color","icon","React","PercentIcon","height","width","text","DigitalIcon","ShowcaseBoxIcon","fill","Skeleton","clsx","--isCheckout","--isCountable","--noDeletable","--noQuantity","Button","disabled","onClick","size","theme","Condition","match","Boolean","createElement","LazyImage","alt","lqip","src","map","sticker","Sticker","Typography","type","kztAmount","slice","stickerIdx","key","CirclePlusIcon","autoComplete","id","onChange","event","Math","abs","target","value","String","CircleMinusIcon"],"mappings":"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"}