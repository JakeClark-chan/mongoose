{"version":3,"file":"Modal.js","sources":["../../../../src/components/other/Modal/Modal.tsx"],"sourcesContent":["import React, { FC, useCallback, useEffect, useState } from 'react'\nimport clsx from 'clsx'\nimport ReactModal from 'react-modal'\nimport { Condition } from '../Condition'\nimport { ArrowDownIcon } from '../../icons/ArrowDown'\nimport { CloseIcon } from '../../icons/Close'\nimport { Typography } from '../Typography'\nimport { ContentVerticalAlign, ModalProps } from './types'\nimport './Modal.scss'\n\nconst defaultProps = {\n  contentLabel: 'Модальное окно',\n  closeBtnText: 'Назад',\n  closeTimeoutMS: 400,\n  contentVerticalAlign: 'middle' as ContentVerticalAlign,\n  isShowCloseBtn: false,\n  isMobilePage: false,\n}\n\nconst Modal: FC<ModalProps> = ({\n  className,\n  children,\n  closeBtnText,\n  contentVerticalAlign,\n  isMobilePage,\n  isShowCloseBtn,\n  isTextClose,\n  onClose,\n  overlayClassName,\n  isOpen,\n  isBodyScrollAllowed = true,\n  onAfterClose,\n  onAfterOpen,\n  iconLeft,\n  title,\n  transitionDuration = 200,\n  withGesture = false,\n  ...props\n}) => {\n  const [touchPositionY, setTouchPositionY] = useState({\n    start: 0,\n    end: 0,\n  })\n  const [mainRef, setMainRef] = useState<HTMLElement | null>(null)\n\n  const handleTouchStart = (event): void => {\n    setTouchPositionY((prev) => ({\n      start: event.changedTouches[0].screenY,\n      end: prev.end,\n    }))\n  }\n\n  const handleTouchEnd = (event): void => {\n    setTouchPositionY((prev) => ({\n      start: prev.start,\n      end: event.changedTouches[0].screenY,\n    }))\n  }\n\n  const handleGesture = useCallback(() => {\n    if (touchPositionY.end - 100 > touchPositionY.start) {\n      onClose({} as any)\n    }\n  }, [touchPositionY.end, touchPositionY.start])\n\n  useEffect(() => {\n    if (!isBodyScrollAllowed || !isOpen) return\n    const topPos = window.scrollY\n    if (isOpen) {\n      document.body.style.top = `-${topPos}px`\n      document.body.style.position = 'fixed'\n      document.body.style.overflow = 'hidden'\n    }\n    return (): void => {\n      document.body.style.removeProperty('position')\n      document.body.style.removeProperty('overflow')\n      document.body.style.removeProperty('top')\n      window.scrollTo(0, topPos)\n    }\n  }, [isOpen])\n\n  useEffect(() => {\n    if (withGesture) handleGesture()\n  }, [touchPositionY.end, withGesture])\n\n  useEffect(() => {\n    if (mainRef && withGesture) {\n      mainRef.addEventListener('touchstart', handleTouchStart, false)\n\n      mainRef.addEventListener('touchend', handleTouchEnd, false)\n    }\n    return (): void => {\n      mainRef?.removeEventListener('touchstart', handleTouchStart)\n      mainRef?.removeEventListener('touchend', handleTouchEnd)\n    }\n  }, [mainRef, withGesture])\n\n  return (\n    <ReactModal\n      ariaHideApp={false}\n      className={clsx('ModalNext', className)}\n      isOpen={isOpen}\n      onAfterClose={onAfterClose}\n      onAfterOpen={onAfterOpen}\n      onRequestClose={onClose}\n      overlayClassName={clsx(\n        'OverlayNext',\n        isMobilePage && '--mobile-page',\n        `ReactModal__Overlay-ContentVerticalAlign-${String(\n          contentVerticalAlign,\n        )[0].toUpperCase()}${contentVerticalAlign?.slice(1)}`,\n        overlayClassName,\n      )}\n      style={{\n        content: {\n          transition: `${transitionDuration}ms`,\n        },\n      }}\n      {...props}\n    >\n      <Condition match={Boolean(isShowCloseBtn)}>\n        <button\n          className={clsx(\n            'ModalNext__CloseBtn',\n            isTextClose\n              ? 'ModalNext__CloseBtn-Text'\n              : 'ModalNext__CloseBtn-Cross',\n            'reset-button-styles',\n          )}\n          onClick={onClose}\n        >\n          <Condition match={Boolean(isTextClose)}>\n            <ArrowDownIcon />\n            <Typography\n              className='ModalNext__CloseBtnText'\n              text={closeBtnText?.trim() || defaultProps.closeBtnText}\n              type='Body2B'\n            />\n          </Condition>\n          <Condition match={!isTextClose}>\n            <CloseIcon height={24} width={24} />\n          </Condition>\n        </button>\n      </Condition>\n      <Condition match={withGesture}>\n        <div\n          ref={(node): void => setMainRef(node)}\n          className='ModalNext__gesture-hide'\n        />\n      </Condition>\n      <Condition match={Boolean(title?.trim())}>\n        {iconLeft && <div className='ModalNext__Icon'>{iconLeft}</div>}\n        <Typography\n          className={clsx(\n            'ModalNext__Title',\n            Boolean(iconLeft) && 'ModalNext_WithLeftIcon',\n          )}\n          text={title as string}\n          type='smallSubtitle'\n        />\n      </Condition>\n      {children}\n    </ReactModal>\n  )\n}\n\nModal.defaultProps = defaultProps\n\nexport default Modal\n"],"names":["defaultProps","contentLabel","closeBtnText","closeTimeoutMS","contentVerticalAlign","isShowCloseBtn","isMobilePage","Modal","_a","className","children","isTextClose","onClose","overlayClassName","isOpen","isBodyScrollAllowed","onAfterClose","onAfterOpen","iconLeft","title","transitionDuration","withGesture","props","touchPositionY","setTouchPositionY","useState","start","end","mainRef","setMainRef","handleTouchStart","event","prev","changedTouches","screenY","handleTouchEnd","handleGesture","useCallback","useEffect","topPos","window","scrollY","document","body","style","top","position","overflow","removeProperty","scrollTo","addEventListener","removeEventListener","React","ReactModal","ariaHideApp","clsx","onRequestClose","String","toUpperCase","slice","content","transition","Condition","match","Boolean","onClick","ArrowDownIcon","Typography","text","trim","type","CloseIcon","height","width","ref","node"],"mappings":"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"}