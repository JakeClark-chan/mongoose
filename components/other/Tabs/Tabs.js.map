{"version":3,"file":"Tabs.js","sources":["../../../../src/components/other/Tabs/Tabs.tsx"],"sourcesContent":["import React, {\n  FC,\n  ReactElement,\n  ReactNode,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport clsx from 'clsx'\nimport ScrollContainer from 'react-indiana-drag-scroll'\nimport { Tab } from './parts'\nimport { TabsProps } from './types'\nimport './Tabs.scss'\nimport { useEffectAfterMount } from '../../../hooks'\nimport { changeRootVar, updateGradients } from './helpers'\nimport { debounce } from '../../../utils/debounce'\nimport { Condition } from '../Condition'\n\nconst Tabs: FC<TabsProps> = ({\n  viewportWidth,\n  centerOnSelectedTab = false,\n  className,\n  children,\n  isGradientNeeded = false,\n  isChips = false,\n  isOutline = false,\n  onChange = (): void => {},\n  selectedTabId,\n  fullControlChange = false,\n  isDestructive = false,\n  isUseSubtitle = false,\n  isMerged = false,\n  chipsSize = 'XXL',\n}) => {\n  const childrenArray: ReactNode[] = useMemo(\n    () =>\n      React.Children.toArray(children).filter(({ type }: any) => type === Tab),\n    [children],\n  )\n\n  const getInitialActiveTab = (): string => {\n    if (childrenArray.length > 0) {\n      if (selectedTabId) {\n        return selectedTabId\n      }\n      return (childrenArray[0] as ReactElement).props.id\n    }\n    return ''\n  }\n\n  const scrollContainerRef = useRef<null | HTMLDivElement>(null)\n  const [activeTab, setActiveTab] = useState(getInitialActiveTab())\n  const activeTabResult = fullControlChange ? selectedTabId : activeTab\n  const [isEqualWidths, setIsEqualWidths] = useState(false)\n\n  const onTabClick = (id: string, evt): void => {\n    setActiveTab(id)\n    onChange(id, evt)\n  }\n\n  useEffectAfterMount(() => {\n    setActiveTab(getInitialActiveTab())\n  }, [React.Children.toArray(children)?.length])\n\n  const handleScroll = (currentX: number, ...scrollDatas: number[]): void => {\n    if (!isGradientNeeded) return\n    if (scrollContainerRef.current) {\n      const { width } = scrollContainerRef.current.getBoundingClientRect()\n      const maxScrollValue = scrollDatas[1]\n      const step = 100\n      const rightOpacity = (maxScrollValue - currentX - width) / step\n      const leftOpacity = currentX / step\n      updateGradients(leftOpacity, rightOpacity)\n    }\n  }\n\n  useEffect(() => {\n    if (scrollContainerRef.current) {\n      const { scrollWidth } = scrollContainerRef.current\n      const {\n        width,\n        height,\n      } = scrollContainerRef.current.getBoundingClientRect()\n      changeRootVar('--tabs-gradient-height', `${height}px`)\n      changeRootVar('--tabs-gradient-width', `${width}px`)\n      setIsEqualWidths(width >= scrollWidth)\n    }\n  }, [scrollContainerRef, viewportWidth])\n\n  const SCROLL_DEBOUNCE_TIME = 30\n  // TODO: сделать возможность устанавливать не линейную зависимость прозрачности\n  // от скролла\n  return (\n    <div\n      className={clsx('Tabs', className, {\n        '--isGradientNeeded': isGradientNeeded,\n      })}\n    >\n      <ScrollContainer\n        className={clsx('Tabs__List', {\n          '--gradient': !isEqualWidths && isGradientNeeded,\n          '--merged': isMerged,\n        })}\n        innerRef={scrollContainerRef}\n        onScroll={(): ((...args: any[]) => void) =>\n          debounce(handleScroll, SCROLL_DEBOUNCE_TIME)\n        }\n      >\n        <Condition match={!isDestructive}>\n          {childrenArray.map(({ props, props: { id } }: ReactElement) => (\n            <Tab\n              {...props}\n              key={id}\n              centerOnSelectedTab={centerOnSelectedTab}\n              chipsSize={chipsSize}\n              isActive={activeTabResult === id}\n              isChips={isChips}\n              isMerged={isMerged}\n              isOutline={isOutline}\n              onClick={onTabClick}\n            />\n          ))}\n        </Condition>\n      </ScrollContainer>\n\n      <div className='Tabs__Content'>\n        {childrenArray.map(\n          ({ props: { children, id, title } }: ReactElement) => {\n            if (id !== activeTabResult && !isDestructive) {\n              return null\n            }\n\n            return (\n              <span key={id}>\n                <Condition match={isUseSubtitle}>\n                  <h3>{title}</h3>\n                </Condition>\n                {children}\n              </span>\n            )\n          },\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default Tabs\n"],"names":["viewportWidth","centerOnSelectedTab","className","children","isGradientNeeded","isChips","isOutline","onChange","selectedTabId","fullControlChange","isDestructive","isUseSubtitle","isMerged","chipsSize","childrenArray","useMemo","React","Children","toArray","filter","type","Tab","getInitialActiveTab","length","props","id","scrollContainerRef","useRef","activeTab","setActiveTab","useState","activeTabResult","isEqualWidths","setIsEqualWidths","onTabClick","evt","useEffectAfterMount","handleScroll","currentX","scrollDatas","current","width","getBoundingClientRect","step","rightOpacity","leftOpacity","updateGradients","useEffect","scrollWidth","height","changeRootVar","clsx","--isGradientNeeded","ScrollContainer","--gradient","--merged","innerRef","onScroll","debounce","Condition","match","map","key","isActive","onClick","title"],"mappings":"gcAmB4B,EAC1BA,cAAAA,EACAC,oBAAAA,GAAsB,EACtBC,UAAAA,EACAC,SAAAA,EACAC,iBAAAA,GAAmB,EACnBC,QAAAA,GAAU,EACVC,UAAAA,GAAY,EACZC,SAAAA,EAAW,SACXC,cAAAA,EACAC,kBAAAA,GAAoB,EACpBC,cAAAA,GAAgB,EAChBC,cAAAA,GAAgB,EAChBC,SAAAA,GAAW,EACXC,UAAAA,EAAY,gBAEZ,MAAMC,EAA6BC,UACjC,IACEC,UAAMC,SAASC,QAAQf,GAAUgB,OAAO,EAAGC,KAAAA,KAAgBA,IAASC,GACtE,CAAClB,IAGGmB,EAAsB,IACtBR,EAAcS,OAAS,EACrBf,GAGIM,EAAc,GAAoBU,MAAMC,GAE3C,GAGHC,EAAqBC,SAA8B,OAClDC,EAAWC,GAAgBC,WAASR,KACrCS,EAAkBtB,EAAoBD,EAAgBoB,GACrDI,EAAeC,GAAoBH,YAAS,GAE7CI,EAAa,CAACT,EAAYU,KAC9BN,EAAaJ,GACblB,EAASkB,EAAIU,IAGfC,sBAAoB,KAClBP,EAAaP,MACZ,WAACN,UAAMC,SAASC,QAAQf,yBAAWoB,SAEtC,MAAMc,EAAe,CAACC,KAAqBC,KACzC,GAAKnC,GACDsB,EAAmBc,QAAS,CAC9B,MAAMC,MAAEA,GAAUf,EAAmBc,QAAQE,wBAEvCC,EAAO,IACPC,GAFiBL,EAAY,GAEID,EAAWG,GAASE,EACrDE,EAAcP,EAAWK,EAC/BG,kBAAgBD,EAAaD,KAIjCG,YAAU,KACR,GAAIrB,EAAmBc,QAAS,CAC9B,MAAMQ,YAAEA,GAAgBtB,EAAmBc,SACrCC,MACJA,EAAKQ,OACLA,GACEvB,EAAmBc,QAAQE,wBAC/BQ,gBAAc,yBAA6BD,EAAH,MACxCC,gBAAc,wBAA4BT,EAAH,MACvCR,EAAiBQ,GAASO,KAE3B,CAACtB,EAAoB1B,IAKxB,OACEgB,+BACEd,UAAWiD,UAAK,OAAQjD,EAAW,CACjCkD,qBAAsBhD,KAGxBY,wBAACqC,WACCnD,UAAWiD,UAAK,aAAc,CAC5BG,cAAetB,GAAiB5B,EAChCmD,WAAY3C,IAEd4C,SAAU9B,EACV+B,SAAU,IACRC,WAASrB,EAhBY,KAmBvBrB,wBAAC2C,GAAUC,OAAQlD,GAChBI,EAAc+C,IAAI,EAAGrC,MAAAA,EAAOA,OAASC,GAAAA,MACpCT,wBAACK,mBACKG,GACJsC,IAAKrC,EACLxB,oBAAqBA,EACrBY,UAAWA,EACXkD,SAAUhC,IAAoBN,EAC9BpB,QAASA,EACTO,SAAUA,EACVN,UAAWA,EACX0D,QAAS9B,QAMjBlB,+BAAKd,UAAU,iBACZY,EAAc+C,IACb,EAAGrC,OAASrB,SAAAA,EAAUsB,GAAAA,EAAIwC,MAAAA,MACpBxC,IAAOM,GAAoBrB,EAK7BM,gCAAM8C,IAAKrC,GACTT,wBAAC2C,GAAUC,MAAOjD,GAChBK,kCAAKiD,IAEN9D,GARI"}