{"version":3,"file":"relay-hooks.js","sources":["../../src/ReactRelayContext.ts","../../src/RelayHooksTypes.ts","../../src/Utils.ts","../../src/FetchResolver.ts","../../src/QueryFetcher.ts","../../src/useForceUpdate.ts","../../src/useRelayEnvironment.ts","../../src/useQuery.ts","../../src/loadQuery.ts","../../src/usePreloadedQuery.ts","../../node_modules/tslib/tslib.es6.js","../../src/getConnectionState.ts","../../src/FragmentResolver.ts","../../src/useOssFragment.tsx","../../src/useFragment.tsx","../../src/useMutation.ts","../../src/useSubscription.ts","../../src/usePagination.ts","../../src/useRefetchable.ts","../../src/RelayEnvironmentProvider.tsx"],"sourcesContent":["/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow strict-local\r\n * @format\r\n */\r\n\r\n'use strict';\r\n\r\nimport * as React from 'react';\r\nimport { __internal } from 'relay-runtime';\r\n\r\nconst { createRelayContext } = __internal as any;\r\n\r\nexport const ReactRelayContext = createRelayContext(React);\r\n","import {\r\n    Disposable,\r\n    OperationType,\r\n    CacheConfig,\r\n    GraphQLTaggedNode,\r\n    IEnvironment,\r\n    MutationConfig as BaseMutationConfig,\r\n    MutationParameters,\r\n    FragmentSpecResolver,\r\n    VariablesOf,\r\n    FragmentReference,\r\n    RenderPolicy,\r\n    GraphQLSubscriptionConfig,\r\n    GraphQLResponse,\r\n} from 'relay-runtime';\r\n\r\nexport type MutationState<T extends MutationParameters> = {\r\n    loading: boolean;\r\n    data: T['response'] | null;\r\n    error?: Error | null;\r\n};\r\n\r\nexport type MutationNode<T extends MutationParameters> = BaseMutationConfig<T>['mutation'];\r\n\r\nexport type MutationConfig<T extends MutationParameters> = Partial<\r\n    Omit<BaseMutationConfig<T>, 'mutation' | 'onCompleted'>\r\n> & {\r\n    onCompleted?(response: T['response']): void;\r\n};\r\n\r\nexport type MutationConfigWithoutVariables<T extends MutationParameters> = Omit<\r\n    MutationConfig<T>,\r\n    'variables'\r\n>;\r\n\r\nexport type Mutate<T extends MutationParameters> = (\r\n    config?: Partial<MutationConfig<T>>,\r\n) => Promise<T['response']>;\r\n\r\nexport type MutateWithVariables<T extends MutationParameters> = (\r\n    config: Partial<MutationConfig<T>> & { variables: T['variables'] },\r\n) => Promise<T['response']>;\r\n\r\nexport const NETWORK_ONLY = 'network-only';\r\nexport const STORE_THEN_NETWORK = 'store-and-network';\r\nexport const STORE_OR_NETWORK = 'store-or-network';\r\nexport const STORE_ONLY = 'store-only';\r\n\r\nexport const PAGINATION_NAME = 'usePagination';\r\nexport const REFETCHABLE_NAME = 'useRefetchable';\r\nexport const FRAGMENT_NAME = 'useFragment';\r\n\r\nexport type FragmentNames = typeof PAGINATION_NAME | typeof REFETCHABLE_NAME | typeof FRAGMENT_NAME;\r\n\r\nexport type FetchPolicy =\r\n    | typeof STORE_ONLY\r\n    | typeof STORE_OR_NETWORK\r\n    | typeof STORE_THEN_NETWORK\r\n    | typeof NETWORK_ONLY;\r\n\r\nexport type ContainerResult = {\r\n    data: { [key: string]: any };\r\n    resolver: FragmentSpecResolver;\r\n};\r\n\r\nexport interface RenderProps<T extends OperationType> {\r\n    error: Error | null;\r\n    data: T['response'] | null | undefined;\r\n    retry: (_cacheConfigOverride?: CacheConfig, options?: Options) => void;\r\n    isLoading: boolean;\r\n}\r\n\r\nexport type QueryOptions = {\r\n    fetchPolicy?: FetchPolicy;\r\n    fetchKey?: string | number;\r\n    networkCacheConfig?: CacheConfig;\r\n    skip?: boolean;\r\n    onResponse?: (response: GraphQLResponse) => void;\r\n    onComplete?: (_e: Error | null) => void;\r\n    UNSTABLE_renderPolicy?: RenderPolicy;\r\n};\r\n\r\nexport type $Call<Fn extends (...args: any[]) => any> = Fn extends (arg: any) => infer RT\r\n    ? RT\r\n    : never;\r\n\r\nexport type KeyType<TData = unknown> = Readonly<{\r\n    ' $data'?: TData;\r\n    ' $fragmentSpreads': FragmentReference;\r\n}>;\r\nexport type ArrayKeyType = ReadonlyArray<{ readonly ' $data'?: ReadonlyArray<unknown> } | null>;\r\n\r\nexport type KeyTypeData<TKey extends KeyType<TData>, TData = unknown> = Required<TKey>[' $data'];\r\n\r\nexport type KeyReturnType<T extends KeyType> = (arg: T) => NonNullable<T[' $data']>;\r\nexport type ArrayKeyReturnType<T extends ArrayKeyType> = (\r\n    arg: T,\r\n) => NonNullable<NonNullable<T[0]>[' $data']>[0];\r\n\r\nexport type LoadMoreFn<TQuery extends OperationType = OperationType> = (\r\n    count: number,\r\n    options?: OptionsLoadMore<TQuery>,\r\n) => Disposable;\r\n\r\n// pagination\r\n\r\nexport const FORWARD = 'forward';\r\n\r\nexport type LoadQuery<\r\n    TOperationType extends OperationType = OperationType,\r\n    TEnvironment extends IEnvironment = IEnvironment\r\n> = {\r\n    next: (\r\n        environment: TEnvironment,\r\n        gqlQuery: GraphQLTaggedNode,\r\n        variables?: TOperationType['variables'],\r\n        options?: QueryOptions,\r\n    ) => Promise<void>;\r\n    subscribe: (callback: () => any) => () => void;\r\n    getValue: (environment?: TEnvironment) => RenderProps<TOperationType> | Promise<any>;\r\n    dispose: () => void;\r\n};\r\n\r\n// refetchable\r\n\r\nexport interface Options {\r\n    fetchPolicy?: FetchPolicy;\r\n    onResponse?: (response: GraphQLResponse) => void;\r\n    onComplete?: (arg: Error | null) => void;\r\n    UNSTABLE_renderPolicy?: RenderPolicy;\r\n}\r\n\r\nexport interface OptionsLoadMore<TQuery extends OperationType = OperationType> {\r\n    //fetchPolicy?: FetchPolicy;\r\n    onResponse?: (response: GraphQLResponse) => void;\r\n    onComplete?: (arg: Error | null) => void;\r\n    UNSTABLE_extraVariables?: VariablesOf<TQuery>;\r\n}\r\n\r\n// NOTE: RefetchFnDynamic returns a refetch function that:\r\n//  - Expects the /exact/ set of query variables if the provided key type is\r\n//    /nullable/.\r\n//  - Or, expects /a subset/ of the query variables if the provided key type is\r\n//    /non-null/.\r\nexport type RefetchFnDynamic<\r\n    TQuery extends OperationType,\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    Key extends KeyType | null,\r\n    TOptions = Options\r\n> = RefetchInexactDynamicResponse<TQuery, TOptions> & RefetchExactDynamicResponse<TQuery, TOptions>;\r\n\r\nexport type RefetchInexact<TQuery extends OperationType, TOptions> = (\r\n    data?: unknown,\r\n) => RefetchFnInexact<TQuery, TOptions>;\r\nexport type RefetchInexactDynamicResponse<TQuery extends OperationType, TOptions> = ReturnType<\r\n    RefetchInexact<TQuery, TOptions>\r\n>;\r\n\r\nexport type RefetchExact<TQuery extends OperationType, TOptions> = (\r\n    data?: unknown | null,\r\n) => RefetchFnExact<TQuery, TOptions>;\r\nexport type RefetchExactDynamicResponse<TQuery extends OperationType, TOptions> = ReturnType<\r\n    RefetchExact<TQuery, TOptions>\r\n>;\r\n\r\nexport type RefetchFnBase<TVars, TOptions> = (vars: TVars, options?: TOptions) => Disposable;\r\n\r\nexport type RefetchFnExact<TQuery extends OperationType, TOptions = Options> = RefetchFnBase<\r\n    VariablesOf<TQuery>,\r\n    TOptions\r\n>;\r\nexport type RefetchFnInexact<TQuery extends OperationType, TOptions = Options> = RefetchFnBase<\r\n    Partial<VariablesOf<TQuery>>,\r\n    TOptions\r\n>;\r\n\r\nexport interface ReturnTypeRefetchNode<\r\n    TQuery extends OperationType,\r\n    TKey extends KeyType | null,\r\n    TFragmentData\r\n> extends ReturnTypeRefetchSuspenseNode<TQuery, TKey, TFragmentData> {\r\n    isLoading: boolean;\r\n    error: Error | null;\r\n}\r\n\r\nexport type ReturnTypeRefetchSuspenseNode<\r\n    TQuery extends OperationType,\r\n    TKey extends KeyType | null,\r\n    TFragmentData\r\n> = { data: TFragmentData; refetch: RefetchFnDynamic<TQuery, TKey> };\r\n\r\n// pagination\r\n\r\nexport interface ReturnTypePagination<\r\n    TQuery extends OperationType,\r\n    TKey extends KeyType | null,\r\n    TFragmentData\r\n> extends ReturnTypePaginationSuspense<TQuery, TKey, TFragmentData> {\r\n    isLoading: boolean;\r\n    error: Error | null;\r\n}\r\n\r\nexport interface ReturnTypePaginationSuspense<\r\n    TQuery extends OperationType,\r\n    TKey extends KeyType | null,\r\n    TFragmentData\r\n> {\r\n    data: TFragmentData;\r\n    loadNext: LoadMoreFn<TQuery>;\r\n    loadPrevious: LoadMoreFn<TQuery>;\r\n    hasNext: boolean;\r\n    hasPrevious: boolean;\r\n    isLoadingNext: boolean;\r\n    isLoadingPrevious: boolean;\r\n    errorNext: Error | null;\r\n    errorPrevious: Error | null;\r\n    refetch: RefetchFnDynamic<TQuery, TKey>;\r\n}\r\n\r\nexport type SubscriptionConfig = {\r\n    skip?: boolean;\r\n};\r\n\r\nexport type SkipSubscriptionConfig = {\r\n    skip: true;\r\n};\r\n\r\nexport interface SkipGraphQLSubscriptionConfig<TSubscription extends OperationType>\r\n    extends Omit<GraphQLSubscriptionConfig<TSubscription>, 'variables' | 'subscription'> {\r\n    subscription?: GraphQLSubscriptionConfig<TSubscription>['subscription'];\r\n    variables?: TSubscription['variables'];\r\n}\r\n","import {\r\n    Variables,\r\n    ConnectionMetadata,\r\n    createOperationDescriptor,\r\n    getRequest,\r\n    GraphQLTaggedNode,\r\n    OperationDescriptor,\r\n    CacheConfig,\r\n} from 'relay-runtime';\r\nimport { STORE_OR_NETWORK, STORE_THEN_NETWORK, NETWORK_ONLY, FetchPolicy } from './RelayHooksTypes';\r\n\r\nexport type ReactConnectionMetadata = ConnectionMetadata & { fragmentName: string };\r\n\r\nexport const isNetworkPolicy = (policy: FetchPolicy, full: boolean): boolean => {\r\n    return (\r\n        policy === NETWORK_ONLY ||\r\n        policy === STORE_THEN_NETWORK ||\r\n        (policy === STORE_OR_NETWORK && !full)\r\n    );\r\n};\r\n\r\nexport const isStorePolicy = (policy: FetchPolicy): boolean => {\r\n    return policy !== NETWORK_ONLY;\r\n};\r\n\r\nexport const forceCache = { force: true };\r\n\r\n// Fetcher\r\nexport function createOperation(\r\n    gqlQuery: GraphQLTaggedNode,\r\n    variables: Variables,\r\n    cacheConfig?: CacheConfig | null,\r\n): OperationDescriptor {\r\n    return createOperationDescriptor(getRequest(gqlQuery), variables, cacheConfig);\r\n}\r\n","import {\r\n    __internal,\r\n    Disposable,\r\n    FetchPolicy,\r\n    Subscription,\r\n    OperationDescriptor,\r\n    IEnvironment,\r\n    Snapshot,\r\n    RenderPolicy,\r\n    GraphQLResponse,\r\n} from 'relay-runtime';\r\nimport { isNetworkPolicy, isStorePolicy } from './Utils';\r\nconst { fetchQuery } = __internal;\r\nconst DATA_RETENTION_TIMEOUT = 30 * 1000;\r\n\r\nexport type Fetcher = {\r\n    fetch: (\r\n        environment: IEnvironment,\r\n        operation: OperationDescriptor,\r\n        fetchPolicy: FetchPolicy | null | undefined,\r\n        onComplete: (_e: Error | null) => void,\r\n        onNext: (\r\n            operation: OperationDescriptor,\r\n            snapshot: Snapshot,\r\n            fromStore?: boolean,\r\n            onlyStore?: boolean,\r\n        ) => void,\r\n        onResponse?: (response: GraphQLResponse | null) => void,\r\n        renderPolicy?: RenderPolicy,\r\n    ) => Disposable;\r\n    getData: () => {\r\n        isLoading: boolean;\r\n        error?: Error | null;\r\n    };\r\n    dispose: () => void;\r\n    checkAndSuspense: (suspense: boolean, useLazy?: boolean) => Promise<any> | Error | null;\r\n};\r\n\r\nexport function fetchResolver({\r\n    setLoading,\r\n    doRetain = true,\r\n    disposeTemporary,\r\n}: {\r\n    doRetain?: boolean;\r\n    setLoading?: (loading: boolean) => void;\r\n    disposeTemporary?: () => void;\r\n}): Fetcher {\r\n    let _refetchSubscription: Subscription | null = null;\r\n    let disposable: Disposable | null = null;\r\n    let releaseQueryTimeout;\r\n    let isLoading = false;\r\n    let query;\r\n    let promise: Promise<any>;\r\n    let error: Error | null = null;\r\n    let env;\r\n\r\n    const updateLoading = (loading: boolean): void => {\r\n        isLoading = loading;\r\n        setLoading && setLoading(isLoading);\r\n    };\r\n    const lookupInStore = (\r\n        environment: IEnvironment,\r\n        operation,\r\n        fetchPolicy,\r\n        renderPolicy: RenderPolicy,\r\n    ): { snapshot: Snapshot | null; full: boolean } => {\r\n        if (isStorePolicy(fetchPolicy)) {\r\n            const check = environment.check(operation);\r\n            const queryStatus = check.status;\r\n            const hasFullQuery = queryStatus === 'available';\r\n            const canPartialRender =\r\n                hasFullQuery || (renderPolicy === 'partial' && queryStatus !== 'stale');\r\n            if (canPartialRender) {\r\n                return { snapshot: environment.lookup(operation.fragment), full: hasFullQuery };\r\n            }\r\n        }\r\n        return { snapshot: null, full: false };\r\n    };\r\n\r\n    const dispose = (): void => {\r\n        clearTemporaryRetain();\r\n        disposable && disposable.dispose();\r\n        disposeRequest();\r\n        disposable = null;\r\n        env = null;\r\n        query = null;\r\n    };\r\n\r\n    const clearTemporaryRetain = (): void => {\r\n        clearTimeout(releaseQueryTimeout);\r\n        releaseQueryTimeout = null;\r\n    };\r\n\r\n    const temporaryRetain = (): void => {\r\n        const localReleaseTemporaryRetain = (): void => {\r\n            clearTemporaryRetain();\r\n            dispose();\r\n            disposeTemporary && disposeTemporary();\r\n        };\r\n        releaseQueryTimeout = setTimeout(localReleaseTemporaryRetain, DATA_RETENTION_TIMEOUT);\r\n    };\r\n\r\n    const disposeRequest = (): void => {\r\n        _refetchSubscription && _refetchSubscription.unsubscribe();\r\n        error = null;\r\n    };\r\n\r\n    const fetch = (\r\n        environment: IEnvironment,\r\n        operation: OperationDescriptor,\r\n        fetchPolicy: FetchPolicy = 'network-only',\r\n        onComplete = (_e: Error | null): void => undefined,\r\n        onNext: (\r\n            operation: OperationDescriptor,\r\n            snapshot: Snapshot,\r\n            fromStore?: boolean,\r\n            onlyStore?: boolean,\r\n        ) => void,\r\n        onResponse?: (response: GraphQLResponse | null) => void,\r\n        renderPolicy?: RenderPolicy,\r\n    ): Disposable => {\r\n        if (env != environment || query.request.identifier !== operation.request.identifier) {\r\n            dispose();\r\n            if (doRetain) {\r\n                disposable = environment.retain(operation);\r\n            }\r\n        }\r\n        env = environment;\r\n        query = operation;\r\n\r\n        disposeRequest();\r\n        const { snapshot, full } = lookupInStore(environment, operation, fetchPolicy, renderPolicy);\r\n        const isNetwork = isNetworkPolicy(fetchPolicy, full);\r\n        if (snapshot != null) {\r\n            const onlyStore = !isNetwork;\r\n            onNext(operation, snapshot, true, onlyStore);\r\n            if (onlyStore) {\r\n                onComplete(null);\r\n            }\r\n        }\r\n        // Cancel any previously running refetch.\r\n        _refetchSubscription && _refetchSubscription.unsubscribe();\r\n        if (isNetwork) {\r\n            let resolveNetworkPromise = (): void => {};\r\n\r\n            // Declare refetchSubscription before assigning it in .start(), since\r\n            // synchronous completion may call callbacks .subscribe() returns.\r\n            let refetchSubscription: Subscription;\r\n            const cleanup = (): void => {\r\n                if (_refetchSubscription === refetchSubscription) {\r\n                    _refetchSubscription = null;\r\n                }\r\n                isLoading = false;\r\n                promise = null;\r\n            };\r\n\r\n            fetchQuery(environment, operation).subscribe({\r\n                unsubscribe: (): void => {\r\n                    cleanup();\r\n                },\r\n                complete: (): void => {\r\n                    resolveNetworkPromise();\r\n                    updateLoading(false);\r\n                    cleanup();\r\n                    onComplete(null);\r\n                },\r\n                error: (e: Error): void => {\r\n                    error = e;\r\n                    resolveNetworkPromise();\r\n                    updateLoading(false);\r\n                    cleanup();\r\n                    onComplete(e);\r\n                },\r\n                next: (response: GraphQLResponse) => {\r\n                    const store = environment.lookup(operation.fragment);\r\n                    promise = null;\r\n                    operation.request.cacheConfig?.poll && updateLoading(false);\r\n                    resolveNetworkPromise();\r\n                    onResponse && onResponse(response);\r\n                    onNext(operation, store);\r\n                },\r\n                start: (subscription) => {\r\n                    refetchSubscription = subscription;\r\n                    _refetchSubscription = refetchSubscription;\r\n                    updateLoading(true);\r\n                },\r\n            });\r\n            if (!snapshot) {\r\n                promise = new Promise((resolve: any) => {\r\n                    resolveNetworkPromise = resolve;\r\n                });\r\n            }\r\n            return {\r\n                dispose: (): void => {\r\n                    refetchSubscription && refetchSubscription.unsubscribe();\r\n                },\r\n            };\r\n        }\r\n        return {\r\n            dispose: (): void => {},\r\n        };\r\n    };\r\n\r\n    const checkAndSuspense = (suspense, useLazy): Promise<any> | Error | null => {\r\n        clearTemporaryRetain();\r\n        const toThrow = promise || error;\r\n        if (suspense && toThrow) {\r\n            if (promise && useLazy) {\r\n                temporaryRetain();\r\n            }\r\n            throw toThrow;\r\n        }\r\n        return toThrow;\r\n    };\r\n\r\n    const getData = (): {\r\n        isLoading: boolean;\r\n        error?: Error | null;\r\n    } => {\r\n        return {\r\n            isLoading,\r\n            error,\r\n        };\r\n    };\r\n\r\n    return {\r\n        fetch,\r\n        getData,\r\n        dispose,\r\n        checkAndSuspense,\r\n    };\r\n}\r\n","import * as areEqual from 'fbjs/lib/areEqual';\r\nimport {\r\n    Disposable,\r\n    CacheConfig,\r\n    IEnvironment,\r\n    Snapshot,\r\n    OperationType,\r\n    OperationDescriptor,\r\n    GraphQLTaggedNode,\r\n    Variables,\r\n} from 'relay-runtime';\r\nimport { Fetcher, fetchResolver } from './FetchResolver';\r\nimport { FetchPolicy, RenderProps, QueryOptions, Options } from './RelayHooksTypes';\r\nimport { createOperation } from './Utils';\r\n\r\nconst defaultPolicy = 'store-or-network';\r\n\r\nconst cache: Map<string, QueryFetcher<any>> = new Map();\r\n\r\nexport function getOrCreateQueryFetcher<TOperationType extends OperationType>(\r\n    useLazy: boolean,\r\n    gqlQuery: GraphQLTaggedNode,\r\n    variables: TOperationType['variables'],\r\n    networkCacheConfig: CacheConfig,\r\n): QueryFetcher<TOperationType> {\r\n    const query = createOperation(gqlQuery, variables, networkCacheConfig);\r\n    const toGet = useLazy && cache.has(query.request.identifier);\r\n    const queryFetcher = toGet ? cache.get(query.request.identifier) : new QueryFetcher();\r\n    queryFetcher.setQuery(gqlQuery, variables, networkCacheConfig, query);\r\n    return queryFetcher;\r\n}\r\n\r\nconst emptyforceUpdate = (): void => undefined;\r\n\r\nexport class QueryFetcher<TOperationType extends OperationType = OperationType> {\r\n    environment: IEnvironment;\r\n    query: OperationDescriptor;\r\n    fetcher: Fetcher;\r\n    rootSubscription: Disposable;\r\n    snapshot: Snapshot;\r\n    fetchPolicy: FetchPolicy;\r\n    fetchKey: string | number;\r\n    variables: Variables;\r\n    cacheConfig: Variables;\r\n    gqlQuery: GraphQLTaggedNode;\r\n    options: QueryOptions;\r\n    forceUpdate = emptyforceUpdate;\r\n    result: RenderProps<TOperationType> = null;\r\n    skip?: boolean;\r\n\r\n    constructor() {\r\n        this.result = {\r\n            retry: this.retry,\r\n            error: null,\r\n            data: null,\r\n            isLoading: false,\r\n        };\r\n        this.fetcher = fetchResolver({\r\n            disposeTemporary: () => {\r\n                this.dispose();\r\n                this.query && cache.delete(this.query.request.identifier);\r\n            },\r\n        });\r\n    }\r\n\r\n    setQuery(\r\n        gqlQuery: GraphQLTaggedNode,\r\n        variables: TOperationType['variables'],\r\n        networkCacheConfig: CacheConfig,\r\n        query: OperationDescriptor,\r\n    ): void {\r\n        this.gqlQuery = gqlQuery;\r\n        this.variables = variables;\r\n        this.query = query;\r\n        this.cacheConfig = networkCacheConfig;\r\n    }\r\n\r\n    getForceUpdate(): () => void {\r\n        return this.forceUpdate;\r\n    }\r\n\r\n    setForceUpdate(forceUpdate): void {\r\n        this.forceUpdate = forceUpdate;\r\n    }\r\n\r\n    dispose(): void {\r\n        this.fetcher.dispose();\r\n        this.disposeSnapshot();\r\n    }\r\n\r\n    disposeSnapshot(): void {\r\n        this.snapshot = null;\r\n        if (this.rootSubscription) {\r\n            this.rootSubscription.dispose();\r\n            this.rootSubscription = null;\r\n        }\r\n    }\r\n\r\n    retry = (cacheConfigOverride?: CacheConfig | null, options: Options = {}): void => {\r\n        const { fetchPolicy = 'network-only' } = options;\r\n        /* eslint-disable indent */\r\n        const query = cacheConfigOverride\r\n            ? createOperation(\r\n                  this.query.request.node,\r\n                  this.query.request.variables,\r\n                  cacheConfigOverride,\r\n              )\r\n            : this.query;\r\n        this.fetch(query, fetchPolicy, options);\r\n        this.resolveResult();\r\n        this.forceUpdate();\r\n    };\r\n\r\n    fetch(\r\n        query: OperationDescriptor,\r\n        fetchPolicy: FetchPolicy,\r\n        options: Options,\r\n        skip?: boolean,\r\n    ): void {\r\n        this.disposeSnapshot();\r\n        if (skip) {\r\n            this.fetcher.dispose();\r\n            return;\r\n        }\r\n\r\n        const { onComplete, onResponse } = options;\r\n        let fetchHasReturned = false;\r\n        const onNext = (_o: OperationDescriptor, snapshot: Snapshot): void => {\r\n            if (!this.snapshot) {\r\n                this.snapshot = snapshot;\r\n                this.subscribe(snapshot);\r\n                this.resolveResult();\r\n                if (fetchHasReturned) {\r\n                    this.forceUpdate();\r\n                }\r\n            }\r\n        };\r\n        const complete = (error: Error | null): void => {\r\n            this.resolveResult();\r\n            if (fetchHasReturned) {\r\n                this.forceUpdate();\r\n            }\r\n            onComplete && onComplete(error);\r\n        };\r\n        this.fetcher.fetch(\r\n            this.environment,\r\n            query,\r\n            fetchPolicy,\r\n            complete,\r\n            onNext,\r\n            onResponse,\r\n            options.UNSTABLE_renderPolicy,\r\n        );\r\n        fetchHasReturned = true;\r\n    }\r\n\r\n    getQuery(gqlQuery, variables, networkCacheConfig): OperationDescriptor | null {\r\n        if (\r\n            gqlQuery != this.gqlQuery ||\r\n            networkCacheConfig != this.cacheConfig ||\r\n            variables != this.variables ||\r\n            !areEqual(variables, this.variables)\r\n        ) {\r\n            this.variables = variables;\r\n            this.gqlQuery = gqlQuery;\r\n            this.cacheConfig = networkCacheConfig;\r\n            return createOperation(gqlQuery, variables, networkCacheConfig);\r\n        }\r\n        return this.query;\r\n    }\r\n\r\n    resolveEnvironment(environment: IEnvironment): void {\r\n        this.resolve(environment, this.gqlQuery, this.variables, this.options);\r\n    }\r\n\r\n    resolve(\r\n        environment: IEnvironment,\r\n        gqlQuery: GraphQLTaggedNode,\r\n        variables: Variables,\r\n        options: QueryOptions,\r\n    ): void {\r\n        const query = this.getQuery(gqlQuery, variables, options.networkCacheConfig);\r\n        const { fetchPolicy = defaultPolicy, fetchKey, skip } = options;\r\n        this.options = options;\r\n        const diffQuery = !this.query || query.request.identifier !== this.query.request.identifier;\r\n        if (\r\n            diffQuery ||\r\n            environment !== this.environment ||\r\n            fetchPolicy !== this.fetchPolicy ||\r\n            fetchKey !== this.fetchKey ||\r\n            skip !== this.skip\r\n        ) {\r\n            this.environment = environment;\r\n            this.query = query;\r\n            this.skip = skip;\r\n            this.fetchPolicy = fetchPolicy;\r\n            this.fetchKey = fetchKey;\r\n            this.fetch(query, fetchPolicy, options, skip);\r\n            this.resolveResult();\r\n        }\r\n    }\r\n\r\n    checkAndSuspense(suspense?: boolean, useLazy?: boolean): Promise<any> | Error | null {\r\n        if (useLazy) {\r\n            this.setForceUpdate(emptyforceUpdate);\r\n            cache.set(this.query.request.identifier, this);\r\n        }\r\n        const result = this.fetcher.checkAndSuspense(suspense, useLazy);\r\n        if (useLazy) {\r\n            cache.delete(this.query.request.identifier);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    getData(): RenderProps<TOperationType> {\r\n        return this.result;\r\n    }\r\n\r\n    resolveResult(): void {\r\n        const { error, isLoading } = this.fetcher.getData();\r\n        this.result = {\r\n            retry: this.retry,\r\n            error,\r\n            data: this.snapshot ? this.snapshot.data : null,\r\n            isLoading,\r\n        };\r\n    }\r\n\r\n    subscribe(snapshot): void {\r\n        if (this.rootSubscription) {\r\n            this.rootSubscription.dispose();\r\n        }\r\n        this.rootSubscription = this.environment.subscribe(snapshot, (snapshot) => {\r\n            // Read from this._fetchOptions in case onDataChange() was lazily added.\r\n            this.snapshot = snapshot;\r\n            //this.error = null;\r\n\r\n            this.resolveResult();\r\n            this.forceUpdate();\r\n        });\r\n    }\r\n}\r\n","import { Reducer, useReducer } from 'react';\r\n\r\nexport function useForceUpdate(): () => void {\r\n    const [, forceUpdate] = useReducer<Reducer<number, void>>((x) => x + 1, 0);\r\n    return forceUpdate as () => void;\r\n}\r\n","import * as React from 'react';\r\nimport { IEnvironment } from 'relay-runtime';\r\nimport { ReactRelayContext } from './ReactRelayContext';\r\n\r\nexport function useRelayEnvironment<\r\n    TEnvironment extends IEnvironment = IEnvironment\r\n>(): TEnvironment {\r\n    const { environment } = React.useContext(ReactRelayContext);\r\n    return environment;\r\n}\r\n","import { useRef, useEffect } from 'react';\r\nimport { GraphQLTaggedNode, OperationType } from 'relay-runtime';\r\nimport { getOrCreateQueryFetcher, QueryFetcher } from './QueryFetcher';\r\nimport { RenderProps, QueryOptions } from './RelayHooksTypes';\r\nimport { useForceUpdate } from './useForceUpdate';\r\nimport { useRelayEnvironment } from './useRelayEnvironment';\r\nimport { forceCache } from './Utils';\r\n\r\ntype Reference<TOperationType extends OperationType = OperationType> = {\r\n    queryFetcher: QueryFetcher<TOperationType>;\r\n};\r\n\r\nconst useInternalQuery = <TOperationType extends OperationType = OperationType>(\r\n    gqlQuery: GraphQLTaggedNode,\r\n    variables: TOperationType['variables'],\r\n    options: QueryOptions,\r\n    suspense: boolean,\r\n): RenderProps<TOperationType> => {\r\n    const environment = useRelayEnvironment();\r\n    const forceUpdate = useForceUpdate();\r\n    const ref = useRef<Reference<TOperationType>>();\r\n    if (ref.current === null || ref.current === undefined) {\r\n        ref.current = {\r\n            queryFetcher: getOrCreateQueryFetcher(\r\n                suspense,\r\n                gqlQuery,\r\n                variables,\r\n                options.networkCacheConfig,\r\n            ),\r\n        };\r\n    }\r\n\r\n    useEffect(() => {\r\n        return (): void => ref.current.queryFetcher.dispose();\r\n    }, []);\r\n\r\n    const { queryFetcher } = ref.current;\r\n    queryFetcher.resolve(environment, gqlQuery, variables, options);\r\n    queryFetcher.checkAndSuspense(suspense, suspense);\r\n    queryFetcher.setForceUpdate(forceUpdate);\r\n    return queryFetcher.getData();\r\n};\r\n\r\nexport const useQuery = <TOperationType extends OperationType = OperationType>(\r\n    gqlQuery: GraphQLTaggedNode,\r\n    variables: TOperationType['variables'] = {},\r\n    options: QueryOptions = {},\r\n): RenderProps<TOperationType> => {\r\n    return useInternalQuery(gqlQuery, variables, options, false);\r\n};\r\n\r\nexport const useLazyLoadQuery = <TOperationType extends OperationType = OperationType>(\r\n    gqlQuery: GraphQLTaggedNode,\r\n    variables: TOperationType['variables'] = {},\r\n    options: QueryOptions = {},\r\n): RenderProps<TOperationType> => {\r\n    options.networkCacheConfig = options.networkCacheConfig ?? forceCache;\r\n    return useInternalQuery(gqlQuery, variables, options, true);\r\n};\r\n","import { GraphQLTaggedNode, OperationType, IEnvironment } from 'relay-runtime';\r\nimport { QueryFetcher } from './QueryFetcher';\r\nimport { RenderProps, QueryOptions, LoadQuery } from './RelayHooksTypes';\r\nimport { forceCache } from './Utils';\r\n\r\nconst emptyFunction = (): void => undefined;\r\n\r\nexport const internalLoadQuery = <TOperationType extends OperationType = OperationType>(\r\n    promise = false,\r\n): LoadQuery<TOperationType> => {\r\n    let queryFetcher = new QueryFetcher<TOperationType>();\r\n\r\n    const dispose = (): void => {\r\n        queryFetcher.dispose();\r\n        queryFetcher.setForceUpdate(emptyFunction);\r\n        queryFetcher = new QueryFetcher<TOperationType>();\r\n    };\r\n\r\n    const next = (\r\n        environment,\r\n        gqlQuery: GraphQLTaggedNode,\r\n        variables: TOperationType['variables'] = {},\r\n        options: QueryOptions = {},\r\n    ): Promise<void> => {\r\n        options.networkCacheConfig = options.networkCacheConfig ?? forceCache;\r\n        queryFetcher.resolve(environment, gqlQuery, variables, options);\r\n        const toThrow = queryFetcher.checkAndSuspense();\r\n        return toThrow\r\n            ? toThrow instanceof Error\r\n                ? Promise.reject(toThrow)\r\n                : toThrow\r\n            : Promise.resolve();\r\n    };\r\n\r\n    const getValue = (\r\n        environment?: IEnvironment,\r\n    ): RenderProps<TOperationType> | null | Promise<any> => {\r\n        queryFetcher.resolveEnvironment(environment);\r\n        queryFetcher.checkAndSuspense(promise);\r\n        return queryFetcher.getData();\r\n    };\r\n\r\n    const subscribe = (callback: () => any): (() => void) => {\r\n        queryFetcher.setForceUpdate(callback);\r\n        return (): void => {\r\n            if (queryFetcher.getForceUpdate() === callback) {\r\n                queryFetcher.setForceUpdate(emptyFunction);\r\n            }\r\n        };\r\n    };\r\n    return {\r\n        next,\r\n        subscribe,\r\n        getValue,\r\n        dispose,\r\n    };\r\n};\r\n\r\nexport const loadLazyQuery = <\r\n    TOperationType extends OperationType = OperationType\r\n>(): LoadQuery<TOperationType> => {\r\n    return internalLoadQuery(true);\r\n};\r\n\r\nexport const loadQuery = <\r\n    TOperationType extends OperationType = OperationType\r\n>(): LoadQuery<TOperationType> => {\r\n    return internalLoadQuery(false);\r\n};\r\n","import { useEffect } from 'react';\r\nimport { OperationType } from 'relay-runtime';\r\nimport { RenderProps, LoadQuery } from './RelayHooksTypes';\r\nimport { useForceUpdate } from './useForceUpdate';\r\nimport { useRelayEnvironment } from './useRelayEnvironment';\r\n\r\nexport const usePreloadedQuery = <TOperationType extends OperationType = OperationType>(\r\n    loadQuery: LoadQuery,\r\n): RenderProps<TOperationType> => {\r\n    const forceUpdate = useForceUpdate();\r\n    const environment = useRelayEnvironment();\r\n\r\n    useEffect(() => {\r\n        return loadQuery.subscribe(forceUpdate);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [loadQuery]);\r\n\r\n    return loadQuery.getValue(environment) as RenderProps<TOperationType>;\r\n};\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import * as invariant from 'fbjs/lib/invariant';\r\nimport { ConnectionInterface, ReaderFragment, getValueAtPath } from 'relay-runtime';\r\n\r\nexport function getStateFromConnection(\r\n    direction: string,\r\n    fragmentNode: ReaderFragment,\r\n    connection: any | null,\r\n): {\r\n    cursor: string | null;\r\n    hasMore: boolean;\r\n} {\r\n    if (connection == null) {\r\n        return { cursor: null, hasMore: false };\r\n    }\r\n    const {\r\n        EDGES,\r\n        PAGE_INFO,\r\n        HAS_NEXT_PAGE,\r\n        HAS_PREV_PAGE,\r\n        END_CURSOR,\r\n        START_CURSOR,\r\n    } = ConnectionInterface.get();\r\n\r\n    invariant(\r\n        typeof connection === 'object',\r\n        'Relay: Expected connection in fragment `%s` to have been `null`, or ' +\r\n            'a plain object with %s and %s properties. Instead got `%s`.',\r\n        fragmentNode.name,\r\n        EDGES,\r\n        PAGE_INFO,\r\n        connection,\r\n    );\r\n\r\n    const edges = connection[EDGES];\r\n    const pageInfo = connection[PAGE_INFO];\r\n    if (edges == null || pageInfo == null) {\r\n        return { cursor: null, hasMore: false };\r\n    }\r\n\r\n    invariant(\r\n        Array.isArray(edges),\r\n        'Relay: Expected connection in fragment `%s` to have a plural `%s` field. ' +\r\n            'Instead got `%s`.',\r\n        fragmentNode.name,\r\n        EDGES,\r\n        edges,\r\n    );\r\n    invariant(\r\n        typeof pageInfo === 'object',\r\n        'Relay: Expected connection in fragment `%s` to have a `%s` field. ' + 'Instead got `%s`.',\r\n        fragmentNode.name,\r\n        PAGE_INFO,\r\n        pageInfo,\r\n    );\r\n\r\n    const cursor =\r\n        direction === 'forward' ? pageInfo[END_CURSOR] ?? null : pageInfo[START_CURSOR] ?? null;\r\n    invariant(\r\n        cursor === null || typeof cursor === 'string',\r\n        'Relay: Expected page info for connection in fragment `%s` to have a ' +\r\n            'valid `%s`. Instead got `%s`.',\r\n        fragmentNode.name,\r\n        START_CURSOR,\r\n        cursor,\r\n    );\r\n\r\n    let hasMore;\r\n    if (direction === 'forward') {\r\n        hasMore = cursor != null && pageInfo[HAS_NEXT_PAGE] === true;\r\n    } else {\r\n        hasMore = cursor != null && pageInfo[HAS_PREV_PAGE] === true;\r\n    }\r\n\r\n    return { cursor, hasMore };\r\n}\r\n\r\nexport function getConnectionState(\r\n    direction: string,\r\n    fragmentNode: ReaderFragment,\r\n    fragmentData: any,\r\n    connectionPathInFragmentData: ReadonlyArray<string | number>,\r\n): {\r\n    cursor: string | null;\r\n    hasMore: boolean;\r\n} {\r\n    const connection = getValueAtPath(fragmentData, connectionPathInFragmentData);\r\n    return getStateFromConnection(direction, fragmentNode, connection);\r\n}\r\n","import * as areEqual from 'fbjs/lib/areEqual';\r\nimport * as invariant from 'fbjs/lib/invariant';\r\nimport * as warning from 'fbjs/lib/warning';\r\nimport {\r\n    __internal,\r\n    getSelector,\r\n    IEnvironment,\r\n    Disposable,\r\n    Snapshot,\r\n    Variables,\r\n    getVariablesFromFragment,\r\n    OperationDescriptor,\r\n    getFragmentIdentifier,\r\n    PluralReaderSelector,\r\n    ReaderSelector,\r\n    SingularReaderSelector,\r\n    ReaderFragment,\r\n    getDataIDsFromFragment,\r\n    RequestDescriptor,\r\n    getPaginationMetadata,\r\n    getPaginationVariables,\r\n    getRefetchMetadata,\r\n    getValueAtPath,\r\n} from 'relay-runtime';\r\nimport { Fetcher, fetchResolver } from './FetchResolver';\r\nimport { getConnectionState, getStateFromConnection } from './getConnectionState';\r\nimport {\r\n    FragmentNames,\r\n    Options,\r\n    OptionsLoadMore,\r\n    PAGINATION_NAME,\r\n    REFETCHABLE_NAME,\r\n} from './RelayHooksTypes';\r\nimport { createOperation, forceCache } from './Utils';\r\nconst { getPromiseForActiveRequest } = __internal;\r\n\r\ntype SingularOrPluralSnapshot = Snapshot | Array<Snapshot>;\r\n\r\nfunction lookupFragment(environment, selector): SingularOrPluralSnapshot {\r\n    return selector.kind === 'PluralReaderSelector'\r\n        ? selector.selectors.map((s) => environment.lookup(s))\r\n        : environment.lookup(selector);\r\n}\r\n\r\nfunction getFragmentResult(snapshot: SingularOrPluralSnapshot): any {\r\n    const missData = isMissingData(snapshot);\r\n    if (Array.isArray(snapshot)) {\r\n        return { snapshot, data: snapshot.map((s) => s.data), isMissingData: missData };\r\n    }\r\n    return { snapshot, data: snapshot.data, isMissingData: missData };\r\n}\r\n\r\ntype FragmentResult = {\r\n    snapshot?: SingularOrPluralSnapshot | null;\r\n    data: any;\r\n    isMissingData?: boolean;\r\n    owner?: any;\r\n};\r\n\r\nfunction isMissingData(snapshot: SingularOrPluralSnapshot): boolean {\r\n    if (Array.isArray(snapshot)) {\r\n        return snapshot.some((s) => s.isMissingData);\r\n    }\r\n    return snapshot.isMissingData;\r\n}\r\n\r\nfunction _getAndSavePromiseForFragmentRequestInFlight(\r\n    fragmentNode: ReaderFragment,\r\n    fragmentOwner: RequestDescriptor,\r\n    env: IEnvironment,\r\n): Promise<void> | null {\r\n    let networkPromise = getPromiseForActiveRequest(env, fragmentOwner);\r\n    let pendingOperationName;\r\n\r\n    if (networkPromise != null) {\r\n        pendingOperationName = fragmentOwner.node.params.name;\r\n    } else {\r\n        const result = env.getOperationTracker().getPendingOperationsAffectingOwner(fragmentOwner);\r\n        const pendingOperations = result?.pendingOperations;\r\n        networkPromise = result?.promise ?? null;\r\n        pendingOperationName =\r\n            pendingOperations?.map((op) => op.node.params.name).join(',') ?? null;\r\n    }\r\n\r\n    if (!networkPromise) {\r\n        return null;\r\n    }\r\n\r\n    if (pendingOperationName == null || pendingOperationName.length === 0) {\r\n        pendingOperationName = 'Unknown pending operation';\r\n    }\r\n\r\n    // When the Promise for the request resolves, we need to make sure to\r\n    // update the cache with the latest data available in the store before\r\n    // resolving the Promise\r\n\r\n    const fragmentName = fragmentNode.name;\r\n    const promiseDisplayName =\r\n        pendingOperationName === fragmentName\r\n            ? `Relay(${pendingOperationName})`\r\n            : `Relay(${pendingOperationName}:${fragmentName})`;\r\n\r\n    (networkPromise as any).displayName = promiseDisplayName;\r\n    return networkPromise;\r\n}\r\n\r\nexport class FragmentResolver {\r\n    _environment: IEnvironment;\r\n    _fragment: ReaderFragment;\r\n    _fragmentRef: any;\r\n    _fragmentRefRefetch: any;\r\n    _idfragment: any;\r\n    _idfragmentrefetch: any;\r\n    resolverData: FragmentResult;\r\n    _disposable: Disposable;\r\n    _selector: ReaderSelector;\r\n    refreshHooks: any;\r\n    fetcherRefecth: Fetcher;\r\n    fetcherNext: Fetcher;\r\n    fetcherPrevious: Fetcher;\r\n    unmounted = false;\r\n    name: string;\r\n    refetchable = false;\r\n    pagination = false;\r\n    result: any;\r\n    _subscribeResolve;\r\n\r\n    constructor(name: FragmentNames) {\r\n        this.name = name;\r\n        this.pagination = name === PAGINATION_NAME;\r\n        this.refetchable = name === REFETCHABLE_NAME || this.pagination;\r\n\r\n        const setLoading = (_loading): void => this.refreshHooks();\r\n        if (this.refetchable) {\r\n            this.fetcherRefecth = fetchResolver({\r\n                setLoading,\r\n                doRetain: true,\r\n            });\r\n        }\r\n        if (this.pagination) {\r\n            this.fetcherNext = fetchResolver({ setLoading });\r\n            this.fetcherPrevious = fetchResolver({ setLoading });\r\n        }\r\n    }\r\n\r\n    setForceUpdate(forceUpdate = (): void => undefined): void {\r\n        this.refreshHooks = (): void => {\r\n            this.resolveResult();\r\n            forceUpdate();\r\n        };\r\n    }\r\n\r\n    subscribeResolve(subscribeResolve: (data: any) => void): void {\r\n        if (this._subscribeResolve && this._subscribeResolve != subscribeResolve) {\r\n            subscribeResolve(this.getData());\r\n        }\r\n        this._subscribeResolve = subscribeResolve;\r\n    }\r\n\r\n    setUnmounted(): void {\r\n        this.unmounted = true;\r\n    }\r\n\r\n    isEqualsFragmentRef(prevFragment, fragmentRef): boolean {\r\n        if (this._fragmentRef !== fragmentRef) {\r\n            const prevIDs = getDataIDsFromFragment(this._fragment, prevFragment);\r\n            const nextIDs = getDataIDsFromFragment(this._fragment, fragmentRef);\r\n            if (\r\n                !areEqual(prevIDs, nextIDs) ||\r\n                !areEqual(\r\n                    this.getFragmentVariables(fragmentRef),\r\n                    this.getFragmentVariables(prevFragment),\r\n                )\r\n            ) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    dispose(): void {\r\n        this.unsubscribe();\r\n        this.fetcherNext && this.fetcherNext.dispose();\r\n        this.fetcherPrevious && this.fetcherPrevious.dispose();\r\n        this._idfragmentrefetch = null;\r\n        this._fragmentRefRefetch = null;\r\n        this.fetcherRefecth && this.fetcherRefecth.dispose();\r\n    }\r\n\r\n    getFragmentVariables(fRef = this._fragmentRef): Variables {\r\n        return getVariablesFromFragment(this._fragment, fRef);\r\n    }\r\n\r\n    resolve(\r\n        environment: IEnvironment,\r\n        idfragment: string,\r\n        fragment: ReaderFragment,\r\n        fragmentRef,\r\n    ): void {\r\n        if (\r\n            !this.resolverData ||\r\n            this._environment !== environment ||\r\n            (idfragment !== this._idfragment &&\r\n                (!this._idfragmentrefetch ||\r\n                    (this._idfragmentrefetch && idfragment !== this._idfragmentrefetch)))\r\n        ) {\r\n            this._fragment = fragment;\r\n            this._fragmentRef = fragmentRef;\r\n            this._idfragment = idfragment;\r\n            this._selector = null;\r\n            this.dispose();\r\n            this._environment = environment;\r\n            this.lookup(fragment, this._fragmentRef);\r\n            this.resolveResult();\r\n        }\r\n    }\r\n\r\n    lookup(fragment, fragmentRef): void {\r\n        if (fragmentRef == null) {\r\n            this.resolverData = { data: null };\r\n            return;\r\n        }\r\n        const isPlural =\r\n            fragment.metadata && fragment.metadata.plural && fragment.metadata.plural === true;\r\n        if (isPlural) {\r\n            if (fragmentRef.length === 0) {\r\n                this.resolverData = { data: [] };\r\n                return;\r\n            }\r\n        }\r\n        this._selector = getSelector(fragment, fragmentRef);\r\n        const snapshot = lookupFragment(this._environment, this._selector);\r\n\r\n        this.resolverData = getFragmentResult(snapshot);\r\n        const owner = this._selector\r\n            ? this._selector.kind === 'PluralReaderSelector'\r\n                ? (this._selector as any).selectors[0].owner\r\n                : (this._selector as any).owner\r\n            : null;\r\n        this.resolverData.owner = owner;\r\n        //this.subscribe();\r\n    }\r\n\r\n    checkAndSuspense(suspense): void {\r\n        if (suspense && this.resolverData.isMissingData && this.resolverData.owner) {\r\n            const fragmentOwner = this.resolverData.owner;\r\n            const networkPromise = _getAndSavePromiseForFragmentRequestInFlight(\r\n                this._fragment,\r\n                fragmentOwner,\r\n                this._environment,\r\n            );\r\n            const parentQueryName = fragmentOwner.node.params.name ?? 'Unknown Parent Query';\r\n            if (networkPromise != null) {\r\n                // When the Promise for the request resolves, we need to make sure to\r\n                // update the cache with the latest data available in the store before\r\n                // resolving the Promise\r\n                const promise = networkPromise\r\n                    .then(() => {\r\n                        if (this._idfragmentrefetch) {\r\n                            this.resolveResult();\r\n                        } else {\r\n                            this._idfragment = null;\r\n                            this.dispose();\r\n                        }\r\n                        //;\r\n                    })\r\n                    .catch((_error: Error) => {\r\n                        if (this._idfragmentrefetch) {\r\n                            this.resolveResult();\r\n                        } else {\r\n                            this._idfragment = null;\r\n                            this.dispose();\r\n                        }\r\n                    });\r\n\r\n                // $FlowExpectedError[prop-missing] Expando to annotate Promises.\r\n                (promise as any).displayName = 'Relay(' + parentQueryName + ')';\r\n                this.unsubscribe();\r\n                this.refreshHooks = (): void => undefined;\r\n                throw promise;\r\n            }\r\n            warning(\r\n                false,\r\n                'Relay: Tried reading fragment `%s` declared in ' +\r\n                    '`%s`, but it has missing data and its parent query `%s` is not ' +\r\n                    'being fetched.\\n' +\r\n                    'This might be fixed by by re-running the Relay Compiler. ' +\r\n                    ' Otherwise, make sure of the following:\\n' +\r\n                    '* You are correctly fetching `%s` if you are using a ' +\r\n                    '\"store-only\" `fetchPolicy`.\\n' +\r\n                    \"* Other queries aren't accidentally fetching and overwriting \" +\r\n                    'the data for this fragment.\\n' +\r\n                    '* Any related mutations or subscriptions are fetching all of ' +\r\n                    'the data for this fragment.\\n' +\r\n                    \"* Any related store updaters aren't accidentally deleting \" +\r\n                    'data for this fragment.',\r\n                this._fragment.name,\r\n                this.name,\r\n                parentQueryName,\r\n                parentQueryName,\r\n            );\r\n        }\r\n        this.fetcherRefecth && this.fetcherRefecth.checkAndSuspense(suspense);\r\n    }\r\n\r\n    getData(): any | null {\r\n        return this.result;\r\n    }\r\n\r\n    resolveResult(): any {\r\n        const { data } = this.resolverData;\r\n        if (this.refetchable || this.pagination) {\r\n            const { isLoading, error } = this.fetcherRefecth.getData();\r\n            const refetch = this.refetch;\r\n            if (!this.pagination) {\r\n                // useRefetchable\r\n                if ('production' !== process.env.NODE_ENV) {\r\n                    getRefetchMetadata(this._fragment, this.name);\r\n                }\r\n                this.result = {\r\n                    data,\r\n                    isLoading,\r\n                    error,\r\n                    refetch,\r\n                };\r\n            } else {\r\n                // usePagination\r\n                const { connectionPathInFragmentData } = getPaginationMetadata(\r\n                    this._fragment,\r\n                    this.name,\r\n                );\r\n\r\n                const connection = getValueAtPath(data, connectionPathInFragmentData);\r\n                const { hasMore: hasNext } = getStateFromConnection(\r\n                    'forward',\r\n                    this._fragment,\r\n                    connection,\r\n                );\r\n                const { hasMore: hasPrevious } = getStateFromConnection(\r\n                    'backward',\r\n                    this._fragment,\r\n                    connection,\r\n                );\r\n                const { isLoading: isLoadingNext, error: errorNext } = this.fetcherNext.getData();\r\n                const {\r\n                    isLoading: isLoadingPrevious,\r\n                    error: errorPrevious,\r\n                } = this.fetcherPrevious.getData();\r\n                this.result = {\r\n                    data,\r\n                    hasNext,\r\n                    isLoadingNext,\r\n                    hasPrevious,\r\n                    isLoadingPrevious,\r\n                    isLoading,\r\n                    errorNext,\r\n                    errorPrevious,\r\n                    error,\r\n                    refetch,\r\n                    loadNext: this.loadNext,\r\n                    loadPrevious: this.loadPrevious,\r\n                };\r\n            }\r\n        } else {\r\n            // useFragment\r\n            this.result = data;\r\n        }\r\n        this._subscribeResolve && this._subscribeResolve(this.result);\r\n    }\r\n\r\n    unsubscribe(): void {\r\n        this._disposable && this._disposable.dispose();\r\n    }\r\n\r\n    subscribe(): void {\r\n        const environment = this._environment;\r\n        const renderedSnapshot = this.resolverData.snapshot;\r\n        this.unsubscribe();\r\n        const dataSubscriptions = [];\r\n        if (renderedSnapshot) {\r\n            if (Array.isArray(renderedSnapshot)) {\r\n                renderedSnapshot.forEach((snapshot, idx) => {\r\n                    dataSubscriptions.push(\r\n                        environment.subscribe(snapshot, (latestSnapshot) => {\r\n                            this.resolverData.snapshot[idx] = latestSnapshot;\r\n                            this.resolverData.data[idx] = latestSnapshot.data;\r\n                            this.resolverData.isMissingData = false;\r\n                            this.refreshHooks();\r\n                        }),\r\n                    );\r\n                });\r\n            } else {\r\n                dataSubscriptions.push(\r\n                    environment.subscribe(renderedSnapshot, (latestSnapshot) => {\r\n                        this.resolverData = getFragmentResult(latestSnapshot);\r\n                        this.resolverData.isMissingData = false;\r\n                        this.refreshHooks();\r\n                    }),\r\n                );\r\n            }\r\n        }\r\n\r\n        this._disposable = {\r\n            dispose: (): void => {\r\n                dataSubscriptions.map((s) => s.dispose());\r\n                this._disposable = undefined;\r\n            },\r\n        };\r\n    }\r\n\r\n    refetch = (variables: Variables, options?: Options): Disposable => {\r\n        if (this.unmounted === true) {\r\n            warning(\r\n                false,\r\n                'Relay: Unexpected call to `refetch` on unmounted component for fragment ' +\r\n                    '`%s` in `%s`. It looks like some instances of your component are ' +\r\n                    'still trying to fetch data but they already unmounted. ' +\r\n                    'Please make sure you clear all timers, intervals, ' +\r\n                    'async calls, etc that may trigger a fetch.',\r\n                this._fragment.name,\r\n                this.name,\r\n            );\r\n            return { dispose: (): void => {} };\r\n        }\r\n        if (this._selector == null) {\r\n            warning(\r\n                false,\r\n                'Relay: Unexpected call to `refetch` while using a null fragment ref ' +\r\n                    'for fragment `%s` in `%s`. When calling `refetch`, we expect ' +\r\n                    \"initial fragment data to be non-null. Please make sure you're \" +\r\n                    'passing a valid fragment ref to `%s` before calling ' +\r\n                    '`refetch`, or make sure you pass all required variables to `refetch`.',\r\n                this._fragment.name,\r\n                this.name,\r\n                this.name,\r\n            );\r\n        }\r\n\r\n        const {\r\n            fragmentRefPathInResponse,\r\n            identifierField,\r\n            refetchableRequest,\r\n        } = getRefetchMetadata(this._fragment, this.name);\r\n        const fragmentData = this.getData().data;\r\n        const identifierValue =\r\n            identifierField != null && fragmentData != null && typeof fragmentData === 'object'\r\n                ? fragmentData[identifierField]\r\n                : null;\r\n\r\n        let parentVariables;\r\n        let fragmentVariables;\r\n        if (this._selector == null) {\r\n            parentVariables = {};\r\n            fragmentVariables = {};\r\n        } else if (this._selector.kind === 'PluralReaderSelector') {\r\n            parentVariables =\r\n                (this._selector as PluralReaderSelector).selectors[0]?.owner.variables ?? {};\r\n            fragmentVariables =\r\n                (this._selector as PluralReaderSelector).selectors[0]?.variables ?? {};\r\n        } else {\r\n            parentVariables = (this._selector as SingularReaderSelector).owner.variables;\r\n            fragmentVariables = (this._selector as SingularReaderSelector).variables;\r\n        }\r\n\r\n        // NOTE: A user of `useRefetchableFragment()` may pass a subset of\r\n        // all variables required by the fragment when calling `refetch()`.\r\n        // We fill in any variables not passed by the call to `refetch()` with the\r\n        // variables from the original parent fragment owner.\r\n        /* $FlowFixMe[cannot-spread-indexer] (>=0.123.0) This comment suppresses\r\n         * an error found when Flow v0.123.0 was deployed. To see the error\r\n         * delete this comment and run Flow. */\r\n        const refetchVariables = {\r\n            ...parentVariables,\r\n            /* $FlowFixMe[exponential-spread] (>=0.111.0) This comment suppresses\r\n             * an error found when Flow v0.111.0 was deployed. To see the error,\r\n             * delete this comment and run Flow. */\r\n            ...fragmentVariables,\r\n            ...variables,\r\n        };\r\n\r\n        if (identifierField != null && !variables.hasOwnProperty('id')) {\r\n            // @refetchable fragments are guaranteed to have an `id` selection\r\n            // if the type is Node, implements Node, or is @fetchable. Double-check\r\n            // that there actually is a value at runtime.\r\n            if (typeof identifierValue !== 'string') {\r\n                warning(\r\n                    false,\r\n                    'Relay: Expected result to have a string  ' +\r\n                        '`%s` in order to refetch, got `%s`.',\r\n                    identifierField,\r\n                    identifierValue,\r\n                );\r\n            }\r\n            refetchVariables.id = identifierValue;\r\n        }\r\n\r\n        const onNext = (operation: OperationDescriptor, snapshot: Snapshot): void => {\r\n            const fragmentRef = getValueAtPath(snapshot.data, fragmentRefPathInResponse);\r\n            const isEquals = this.isEqualsFragmentRef(\r\n                this._fragmentRefRefetch || this._fragmentRef,\r\n                fragmentRef,\r\n            );\r\n            const missData = isMissingData(snapshot); //fromStore && isMissingData(snapshot);\r\n            if (!isEquals || missData) {\r\n                this._fragmentRefRefetch = fragmentRef;\r\n                this._idfragmentrefetch = getFragmentIdentifier(this._fragment, fragmentRef);\r\n                this.lookup(this._fragment, fragmentRef);\r\n                this.subscribe();\r\n                /*if (!missData) {\r\n                    this.subscribe();\r\n                }*/\r\n                this.resolverData.isMissingData = missData;\r\n                this.resolverData.owner = operation.request;\r\n                this.refreshHooks();\r\n            }\r\n        };\r\n        if (this.pagination) {\r\n            this.fetcherNext.dispose();\r\n            this.fetcherPrevious.dispose();\r\n        }\r\n        const operation = createOperation(refetchableRequest, refetchVariables, forceCache);\r\n        return this.fetcherRefecth.fetch(\r\n            this._environment,\r\n            operation,\r\n            options?.fetchPolicy,\r\n            options?.onComplete,\r\n            onNext,\r\n            options?.onResponse,\r\n            options?.UNSTABLE_renderPolicy,\r\n        );\r\n    };\r\n\r\n    loadPrevious = (count: number, options?: OptionsLoadMore): Disposable => {\r\n        return this.loadMore('backward', count, options);\r\n    };\r\n\r\n    loadNext = (count: number, options?: OptionsLoadMore): Disposable => {\r\n        return this.loadMore('forward', count, options);\r\n    };\r\n\r\n    loadMore = (\r\n        direction: 'backward' | 'forward',\r\n        count: number,\r\n        options?: OptionsLoadMore,\r\n    ): Disposable => {\r\n        const onComplete = options?.onComplete ?? ((): void => undefined);\r\n\r\n        const fragmentData = this.getData().data;\r\n\r\n        const fetcher = direction === 'backward' ? this.fetcherPrevious : this.fetcherNext;\r\n        if (this.unmounted === true) {\r\n            // Bail out and warn if we're trying to paginate after the component\r\n            // has unmounted\r\n            warning(\r\n                false,\r\n                'Relay: Unexpected fetch on unmounted component for fragment ' +\r\n                    '`%s` in `%s`. It looks like some instances of your component are ' +\r\n                    'still trying to fetch data but they already unmounted. ' +\r\n                    'Please make sure you clear all timers, intervals, ' +\r\n                    'async calls, etc that may trigger a fetch.',\r\n                this._fragment.name,\r\n                this.name,\r\n            );\r\n            return { dispose: (): void => {} };\r\n        }\r\n        if (this._selector == null) {\r\n            warning(\r\n                false,\r\n                'Relay: Unexpected fetch while using a null fragment ref ' +\r\n                    'for fragment `%s` in `%s`. When fetching more items, we expect ' +\r\n                    \"initial fragment data to be non-null. Please make sure you're \" +\r\n                    'passing a valid fragment ref to `%s` before paginating.',\r\n                this._fragment.name,\r\n                this.name,\r\n                this.name,\r\n            );\r\n            onComplete(null);\r\n            return { dispose: (): void => {} };\r\n        }\r\n        const isRequestActive = (this._environment as any).isRequestActive(\r\n            (this._selector as SingularReaderSelector).owner.identifier,\r\n        );\r\n        if (isRequestActive || fetcher.getData().isLoading === true || fragmentData == null) {\r\n            onComplete(null);\r\n            return { dispose: (): void => {} };\r\n        }\r\n        invariant(\r\n            this._selector != null && this._selector.kind !== 'PluralReaderSelector',\r\n            'Relay: Expected to be able to find a non-plural fragment owner for ' +\r\n                \"fragment `%s` when using `%s`. If you're seeing this, \" +\r\n                'this is likely a bug in Relay.',\r\n            this._fragment.name,\r\n            this.name,\r\n        );\r\n\r\n        const {\r\n            paginationRequest,\r\n            paginationMetadata,\r\n            identifierField,\r\n            connectionPathInFragmentData,\r\n        } = getPaginationMetadata(this._fragment, this.name);\r\n        const identifierValue =\r\n            identifierField != null && fragmentData != null && typeof fragmentData === 'object'\r\n                ? fragmentData[identifierField]\r\n                : null;\r\n\r\n        const parentVariables = (this._selector as SingularReaderSelector).owner.variables;\r\n        const fragmentVariables = (this._selector as SingularReaderSelector).variables;\r\n        const extraVariables = options?.UNSTABLE_extraVariables;\r\n        const baseVariables = {\r\n            ...parentVariables,\r\n            ...fragmentVariables,\r\n        };\r\n        const { cursor } = getConnectionState(\r\n            direction,\r\n            this._fragment,\r\n            fragmentData,\r\n            connectionPathInFragmentData,\r\n        );\r\n        const paginationVariables = getPaginationVariables(\r\n            direction,\r\n            count,\r\n            cursor,\r\n            baseVariables,\r\n            { ...extraVariables },\r\n            paginationMetadata,\r\n        );\r\n\r\n        // If the query needs an identifier value ('id' or similar) and one\r\n        // was not explicitly provided, read it from the fragment data.\r\n        if (identifierField != null) {\r\n            // @refetchable fragments are guaranteed to have an `id` selection\r\n            // if the type is Node, implements Node, or is @fetchable. Double-check\r\n            // that there actually is a value at runtime.\r\n            if (typeof identifierValue !== 'string') {\r\n                warning(\r\n                    false,\r\n                    'Relay: Expected result to have a string  ' +\r\n                        '`%s` in order to refetch, got `%s`.',\r\n                    identifierField,\r\n                    identifierValue,\r\n                );\r\n            }\r\n            paginationVariables.id = identifierValue;\r\n        }\r\n\r\n        const onNext = (): void => {};\r\n\r\n        const operation = createOperation(paginationRequest, paginationVariables, forceCache);\r\n        return fetcher.fetch(\r\n            this._environment,\r\n            operation,\r\n            undefined, //options?.fetchPolicy,\r\n            onComplete,\r\n            onNext,\r\n            options?.onResponse,\r\n        );\r\n    };\r\n}\r\n","import * as warning from 'fbjs/lib/warning';\r\nimport { useEffect, useRef, useMemo } from 'react';\r\nimport { GraphQLTaggedNode, getFragmentIdentifier, getFragment } from 'relay-runtime';\r\nimport { FragmentResolver } from './FragmentResolver';\r\nimport { FragmentNames } from './RelayHooksTypes';\r\nimport { useForceUpdate } from './useForceUpdate';\r\nimport { useRelayEnvironment } from './useRelayEnvironment';\r\n\r\nexport function useOssFragment(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: any | null,\r\n    suspense: boolean,\r\n    name: FragmentNames,\r\n    subscribeResolve?: (data: any) => void,\r\n): any {\r\n    const environment = useRelayEnvironment();\r\n    const forceUpdate = useForceUpdate();\r\n    const ref = useRef<{ resolver: FragmentResolver }>(null);\r\n    if (ref.current === null || ref.current === undefined) {\r\n        ref.current = {\r\n            resolver: new FragmentResolver(name),\r\n        };\r\n    }\r\n\r\n    const { resolver } = ref.current;\r\n\r\n    useEffect(() => {\r\n        return (): void => {\r\n            ref.current.resolver.setUnmounted();\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        return (): void => {\r\n            resolver.dispose();\r\n        };\r\n    }, [resolver]);\r\n\r\n    const fragment = useMemo(() => {\r\n        return getFragment(fragmentNode);\r\n    }, [fragmentNode]);\r\n\r\n    const idfragment = useMemo(() => {\r\n        return getFragmentIdentifier(fragment, fragmentRef);\r\n    }, [fragment, fragmentRef]);\r\n\r\n    useEffect(() => {\r\n        resolver.subscribe();\r\n        return (): void => {\r\n            resolver.unsubscribe();\r\n        };\r\n    }, [resolver, idfragment, environment]);\r\n\r\n    resolver.subscribeResolve(subscribeResolve);\r\n\r\n    resolver.resolve(environment, idfragment, fragment, fragmentRef);\r\n    if (subscribeResolve) {\r\n        resolver.setForceUpdate();\r\n        return;\r\n    }\r\n\r\n    resolver.checkAndSuspense(suspense);\r\n    resolver.setForceUpdate(forceUpdate);\r\n\r\n    const data = resolver.getData();\r\n\r\n    if ('production' !== process.env.NODE_ENV) {\r\n        if (\r\n            fragmentRef != null &&\r\n            (data === undefined ||\r\n                (Array.isArray(data) &&\r\n                    data.length > 0 &&\r\n                    data.every((data) => data === undefined)))\r\n        ) {\r\n            warning(\r\n                false,\r\n                'Relay: Expected to have been able to read non-null data for ' +\r\n                    'fragment `%s` declared in ' +\r\n                    '`%s`, since fragment reference was non-null. ' +\r\n                    \"Make sure that that `%s`'s parent isn't \" +\r\n                    'holding on to and/or passing a fragment reference for data that ' +\r\n                    'has been deleted.',\r\n                fragment,\r\n                name,\r\n                name,\r\n            );\r\n        }\r\n    }\r\n\r\n    return [data, resolver];\r\n}\r\n","import { GraphQLTaggedNode } from 'relay-runtime';\r\nimport {\r\n    KeyType,\r\n    KeyReturnType,\r\n    $Call,\r\n    ArrayKeyType,\r\n    ArrayKeyReturnType,\r\n    FRAGMENT_NAME,\r\n} from './RelayHooksTypes';\r\nimport { useOssFragment } from './useOssFragment';\r\n\r\nexport function useFragment<TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): $Call<KeyReturnType<TKey>>;\r\nexport function useFragment<TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): $Call<KeyReturnType<TKey>> | null;\r\nexport function useFragment<TKey extends ArrayKeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): ReadonlyArray<$Call<ArrayKeyReturnType<TKey>>>;\r\nexport function useFragment<TKey extends ArrayKeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): ReadonlyArray<$Call<ArrayKeyReturnType<TKey>>> {\r\n    const [data] = useOssFragment(fragmentNode, fragmentRef, false, FRAGMENT_NAME);\r\n    return data;\r\n}\r\n\r\nexport function useSuspenseFragment<TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): $Call<KeyReturnType<TKey>>;\r\nexport function useSuspenseFragment<TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): $Call<KeyReturnType<TKey>> | null;\r\nexport function useSuspenseFragment<TKey extends ArrayKeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): ReadonlyArray<$Call<ArrayKeyReturnType<TKey>>>;\r\nexport function useSuspenseFragment<TKey extends ArrayKeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): ReadonlyArray<$Call<ArrayKeyReturnType<TKey>>> {\r\n    const [data] = useOssFragment(fragmentNode, fragmentRef, true, FRAGMENT_NAME);\r\n    return data;\r\n}\r\n\r\nexport function useFragmentSubscription<TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n    callback: (data: $Call<KeyReturnType<TKey>>) => void,\r\n): void;\r\nexport function useFragmentSubscription<TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n    callback: (data: $Call<KeyReturnType<TKey>> | null) => void,\r\n): void;\r\nexport function useFragmentSubscription<TKey extends ArrayKeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n    callback: (data: ReadonlyArray<$Call<ArrayKeyReturnType<TKey>>>) => void,\r\n): void;\r\nexport function useFragmentSubscription<TKey extends ArrayKeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n    callback: (data: ReadonlyArray<$Call<ArrayKeyReturnType<TKey>>>) => void,\r\n): void {\r\n    useOssFragment(fragmentNode, fragmentRef, false, FRAGMENT_NAME, callback);\r\n}\r\n","import useMounted from '@restart/hooks/useMounted';\r\nimport * as invariant from 'fbjs/lib/invariant';\r\nimport * as React from 'react';\r\nimport { Environment, MutationParameters, commitMutation } from 'relay-runtime';\r\nimport {\r\n    MutationNode,\r\n    MutationConfig,\r\n    MutationConfigWithoutVariables,\r\n    MutationState,\r\n    Mutate,\r\n    MutateWithVariables,\r\n} from './RelayHooksTypes';\r\nimport { useRelayEnvironment } from './useRelayEnvironment';\r\n\r\nconst { useCallback, useState } = React;\r\n\r\nexport function useMutation<T extends MutationParameters>(\r\n    mutation: MutationNode<T>,\r\n    userConfig?: MutationConfigWithoutVariables<T>,\r\n    /** if not provided, the context environment will be used. */\r\n    environment?: Environment,\r\n): [MutateWithVariables<T>, MutationState<T>];\r\nexport function useMutation<T extends MutationParameters>(\r\n    mutation: MutationNode<T>,\r\n    userConfig?: MutationConfig<T>,\r\n    /** if not provided, the context environment will be used. */\r\n    environment?: Environment,\r\n): [Mutate<T>, MutationState<T>];\r\nexport function useMutation<T extends MutationParameters>(\r\n    mutation: MutationNode<T>,\r\n    userConfig: MutationConfig<T> = {},\r\n    /** if not provided, the context environment will be used. */\r\n    environment?: Environment,\r\n): [Mutate<T>, MutationState<T>] {\r\n    const [state, setState] = useState<MutationState<T>>({\r\n        loading: false,\r\n        data: null,\r\n        error: null,\r\n    });\r\n\r\n    const isMounted = useMounted();\r\n\r\n    const relayEnvironment = useRelayEnvironment();\r\n    const resolvedEnvironment = environment || relayEnvironment;\r\n    const {\r\n        configs,\r\n        variables,\r\n        uploadables,\r\n        onCompleted,\r\n        onError,\r\n        optimisticUpdater,\r\n        optimisticResponse,\r\n        updater,\r\n    } = userConfig;\r\n\r\n    const mutate: Mutate<T> = useCallback(\r\n        (config) => {\r\n            const mergedConfig = {\r\n                configs,\r\n                variables,\r\n                uploadables,\r\n                onCompleted,\r\n                onError,\r\n                optimisticUpdater,\r\n                optimisticResponse,\r\n                updater,\r\n                ...config,\r\n            };\r\n\r\n            invariant(mergedConfig.variables, 'you must specify variables');\r\n\r\n            if (isMounted()) {\r\n                setState({\r\n                    loading: true,\r\n                    data: mergedConfig.optimisticResponse,\r\n                    error: null,\r\n                });\r\n            }\r\n\r\n            return new Promise((resolve, reject) => {\r\n                function handleError(error: any): void {\r\n                    if (isMounted()) {\r\n                        setState({\r\n                            loading: false,\r\n                            data: null,\r\n                            error,\r\n                        });\r\n                    }\r\n\r\n                    if (mergedConfig.onError) {\r\n                        mergedConfig.onError(error);\r\n                        resolve(null);\r\n                    } else {\r\n                        reject(error);\r\n                    }\r\n                }\r\n\r\n                commitMutation(resolvedEnvironment, {\r\n                    ...mergedConfig,\r\n                    mutation,\r\n                    variables: mergedConfig.variables,\r\n                    onCompleted: (response, errors) => {\r\n                        if (errors) {\r\n                            // FIXME: This isn't right. onError expects a single error.\r\n                            handleError(errors);\r\n                            return;\r\n                        }\r\n\r\n                        if (isMounted()) {\r\n                            setState({\r\n                                loading: false,\r\n                                data: response,\r\n                                error: null,\r\n                            });\r\n                        }\r\n\r\n                        if (mergedConfig.onCompleted) {\r\n                            mergedConfig.onCompleted(response);\r\n                        }\r\n                        resolve(response);\r\n                    },\r\n                    onError: handleError,\r\n                });\r\n            });\r\n        },\r\n        [\r\n            resolvedEnvironment,\r\n            configs,\r\n            mutation,\r\n            variables,\r\n            uploadables,\r\n            onCompleted,\r\n            onError,\r\n            optimisticUpdater,\r\n            optimisticResponse,\r\n            updater,\r\n            isMounted,\r\n        ],\r\n    );\r\n\r\n    return [mutate, state];\r\n}\r\n","import { useEffect } from 'react';\r\nimport { GraphQLSubscriptionConfig, requestSubscription, OperationType } from 'relay-runtime';\r\nimport {\r\n    SkipGraphQLSubscriptionConfig,\r\n    SkipSubscriptionConfig,\r\n    SubscriptionConfig,\r\n} from './RelayHooksTypes';\r\nimport { useRelayEnvironment } from './useRelayEnvironment';\r\n\r\nexport function useSubscription<TSubscriptionPayload extends OperationType = OperationType>(\r\n    config: GraphQLSubscriptionConfig<TSubscriptionPayload>,\r\n    opts?: SubscriptionConfig,\r\n): void;\r\nexport function useSubscription<TSubscriptionPayload extends OperationType = OperationType>(\r\n    config: SkipGraphQLSubscriptionConfig<TSubscriptionPayload>,\r\n    opts: SkipSubscriptionConfig,\r\n): void;\r\nexport function useSubscription<TSubscriptionPayload extends OperationType = OperationType>(\r\n    config: GraphQLSubscriptionConfig<TSubscriptionPayload>,\r\n    opts?: SubscriptionConfig,\r\n): void {\r\n    const environment = useRelayEnvironment();\r\n    const skip = opts && opts.skip;\r\n\r\n    useEffect(() => {\r\n        if (skip) {\r\n            return;\r\n        }\r\n        const { dispose } = requestSubscription(environment, config);\r\n        return dispose;\r\n    }, [environment, config, skip]);\r\n}\r\n","import { GraphQLTaggedNode, OperationType } from 'relay-runtime';\r\nimport {\r\n    KeyType,\r\n    KeyTypeData,\r\n    PAGINATION_NAME,\r\n    ReturnTypePagination,\r\n    ReturnTypePaginationSuspense,\r\n} from './RelayHooksTypes';\r\nimport { useOssFragment } from './useOssFragment';\r\n\r\nexport function usePagination<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypePagination<TQuery, TKey, KeyTypeData<TKey>>;\r\nexport function usePagination<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypePagination<TQuery, TKey | null, KeyTypeData<TKey> | null> {\r\n    const [data] = useOssFragment(fragmentNode, fragmentRef, false, PAGINATION_NAME);\r\n    return data;\r\n}\r\n\r\nexport function usePaginationFragment<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypePaginationSuspense<TQuery, TKey, KeyTypeData<TKey>>;\r\nexport function usePaginationFragment<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypePaginationSuspense<TQuery, TKey | null, KeyTypeData<TKey> | null> {\r\n    const [data] = useOssFragment(fragmentNode, fragmentRef, true, PAGINATION_NAME);\r\n    return data;\r\n}\r\n\r\nexport function usePaginationSubscription<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n    callback: (data: ReturnTypePagination<TQuery, TKey, KeyTypeData<TKey>>) => void,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nvoid;\r\nexport function usePaginationSubscription<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentNode: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n    callback: (data: ReturnTypePagination<TQuery, TKey | null, KeyTypeData<TKey> | null>) => void,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nvoid {\r\n    useOssFragment(fragmentNode, fragmentRef, false, PAGINATION_NAME, callback);\r\n}\r\n","import { GraphQLTaggedNode, OperationType } from 'relay-runtime';\r\nimport {\r\n    KeyType,\r\n    KeyTypeData,\r\n    REFETCHABLE_NAME,\r\n    ReturnTypeRefetchNode,\r\n    ReturnTypeRefetchSuspenseNode,\r\n} from './RelayHooksTypes';\r\nimport { useOssFragment } from './useOssFragment';\r\n\r\nexport function useRefetchable<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentInput: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypeRefetchNode<TQuery, TKey, KeyTypeData<TKey>>;\r\nexport function useRefetchable<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentInput: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypeRefetchNode<TQuery, TKey, KeyTypeData<TKey> | null> {\r\n    const [data] = useOssFragment(fragmentInput, fragmentRef, false, REFETCHABLE_NAME);\r\n    return data;\r\n}\r\n\r\nexport function useRefetchableFragment<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentInput: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypeRefetchSuspenseNode<TQuery, TKey, KeyTypeData<TKey>>;\r\nexport function useRefetchableFragment<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentInput: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nReturnTypeRefetchSuspenseNode<TQuery, TKey, KeyTypeData<TKey> | null> {\r\n    const [data] = useOssFragment(fragmentInput, fragmentRef, true, REFETCHABLE_NAME);\r\n    return data;\r\n}\r\n\r\nexport function useRefetchableSubscription<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentInput: GraphQLTaggedNode,\r\n    fragmentRef: TKey,\r\n    callback: (data: ReturnTypeRefetchNode<TQuery, TKey, KeyTypeData<TKey>>) => void,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nvoid;\r\nexport function useRefetchableSubscription<TQuery extends OperationType, TKey extends KeyType>(\r\n    fragmentInput: GraphQLTaggedNode,\r\n    fragmentRef: TKey | null,\r\n    callback: (data: ReturnTypeRefetchNode<TQuery, TKey, KeyTypeData<TKey> | null>) => void,\r\n): // tslint:disable-next-line no-unnecessary-generics\r\nvoid {\r\n    useOssFragment(fragmentInput, fragmentRef, false, REFETCHABLE_NAME, callback);\r\n}\r\n","import * as React from 'react';\r\nimport { Environment } from 'relay-runtime';\r\nimport { ReactRelayContext } from './ReactRelayContext'; // eslint-disable-line @typescript-eslint/no-unused-vars\r\n\r\nexport const RelayEnvironmentProvider = function<\r\n    TEnvironment extends Environment = Environment\r\n>(props: { children: React.ReactNode; environment: TEnvironment }): JSX.Element {\r\n    const context = React.useMemo(() => ({ environment: props.environment }), [props.environment]);\r\n    return (\r\n        <ReactRelayContext.Provider value={context}>{props.children}</ReactRelayContext.Provider>\r\n    );\r\n};\r\n"],"names":["createRelayContext","__internal","ReactRelayContext","React","NETWORK_ONLY","STORE_THEN_NETWORK","STORE_OR_NETWORK","STORE_ONLY","PAGINATION_NAME","REFETCHABLE_NAME","FRAGMENT_NAME","FORWARD","isNetworkPolicy","policy","full","isStorePolicy","forceCache","force","createOperation","gqlQuery","variables","cacheConfig","createOperationDescriptor","getRequest","fetchQuery","DATA_RETENTION_TIMEOUT","fetchResolver","_a","setLoading","_b","doRetain","disposeTemporary","_refetchSubscription","disposable","releaseQueryTimeout","isLoading","query","promise","error","env","updateLoading","loading","lookupInStore","environment","operation","fetchPolicy","renderPolicy","check","queryStatus","status","hasFullQuery","canPartialRender","snapshot","lookup","fragment","dispose","clearTemporaryRetain","disposeRequest","clearTimeout","temporaryRetain","localReleaseTemporaryRetain","setTimeout","unsubscribe","fetch","onComplete","onNext","onResponse","_e","undefined","request","identifier","retain","isNetwork","onlyStore","resolveNetworkPromise_1","refetchSubscription_1","cleanup_1","subscribe","complete","e","next","response","store","poll","start","subscription","Promise","resolve","checkAndSuspense","suspense","useLazy","toThrow","getData","defaultPolicy","cache","Map","getOrCreateQueryFetcher","networkCacheConfig","toGet","has","queryFetcher","get","QueryFetcher","setQuery","emptyforceUpdate","cacheConfigOverride","options","_this","node","resolveResult","forceUpdate","result","retry","data","fetcher","delete","disposeSnapshot","rootSubscription","skip","fetchHasReturned","_o","UNSTABLE_renderPolicy","areEqual","getQuery","fetchKey","diffQuery","setForceUpdate","set","useForceUpdate","useReducer","x","useRelayEnvironment","useContext","useInternalQuery","ref","useRef","current","useEffect","useQuery","useLazyLoadQuery","emptyFunction","internalLoadQuery","Error","reject","getValue","resolveEnvironment","callback","getForceUpdate","loadLazyQuery","loadQuery","usePreloadedQuery","getStateFromConnection","direction","fragmentNode","connection","cursor","hasMore","_c","ConnectionInterface","EDGES","PAGE_INFO","HAS_NEXT_PAGE","HAS_PREV_PAGE","END_CURSOR","START_CURSOR","invariant","name","edges","pageInfo","Array","isArray","getConnectionState","fragmentData","connectionPathInFragmentData","getValueAtPath","getPromiseForActiveRequest","lookupFragment","selector","kind","selectors","map","s","getFragmentResult","missData","isMissingData","some","_getAndSavePromiseForFragmentRequestInFlight","fragmentOwner","networkPromise","pendingOperationName","params","getOperationTracker","getPendingOperationsAffectingOwner","pendingOperations","op","join","length","fragmentName","promiseDisplayName","displayName","unmounted","warning","_fragment","_selector","getRefetchMetadata","fragmentRefPathInResponse","identifierField","refetchableRequest","identifierValue","parentVariables","fragmentVariables","owner","refetchVariables","hasOwnProperty","id","fragmentRef","isEquals","isEqualsFragmentRef","_fragmentRefRefetch","_fragmentRef","_idfragmentrefetch","getFragmentIdentifier","resolverData","refreshHooks","pagination","fetcherNext","fetcherPrevious","fetcherRefecth","_environment","count","loadMore","isRequestActive","getPaginationMetadata","paginationRequest","paginationMetadata","extraVariables","UNSTABLE_extraVariables","baseVariables","paginationVariables","getPaginationVariables","refetchable","_loading","FragmentResolver","subscribeResolve","_subscribeResolve","prevFragment","prevIDs","getDataIDsFromFragment","nextIDs","getFragmentVariables","fRef","getVariablesFromFragment","idfragment","_idfragment","isPlural","metadata","plural","getSelector","parentQueryName","then","catch","_error","refetch","hasNext","hasPrevious","isLoadingNext","errorNext","isLoadingPrevious","errorPrevious","loadNext","loadPrevious","_disposable","renderedSnapshot","dataSubscriptions","forEach","idx","push","latestSnapshot","useOssFragment","resolver","setUnmounted","useMemo","getFragment","every","useFragment","useSuspenseFragment","useFragmentSubscription","useCallback","useState","useMutation","mutation","userConfig","state","setState","isMounted","useMounted","relayEnvironment","resolvedEnvironment","configs","uploadables","onCompleted","onError","optimisticUpdater","optimisticResponse","updater","mutate","config","mergedConfig","handleError","commitMutation","errors","useSubscription","opts","requestSubscription","usePagination","usePaginationFragment","usePaginationSubscription","useRefetchable","fragmentInput","useRefetchableFragment","useRefetchableSubscription","RelayEnvironmentProvider","props","context","Provider","value","children"],"mappings":"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"}